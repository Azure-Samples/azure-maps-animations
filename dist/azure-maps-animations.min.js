/* MIT License - Copyright (c) Microsoft Corporation. */


!function(t,g){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function e(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},n=(r.merge=function(t,e){for(var n=window||global,i=0,r=t.split(".");i<r.length;i++){var s=r[i];if(!n[s])return e;n=n[s]}return o(o({},n),e)},r);function r(){}var s=(a.linear=function(t){return t},a.easeInSine=function(t){return 1-Math.cos(t*Math.PI*.5)},a.easeOutSine=function(t){return Math.sin(t*Math.PI*.5)},a.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},a.easeInQuad=function(t){return t*t},a.easeOutQuad=function(t){return t*(2-t)},a.easeInOutQuad=function(t){return t<.5?2*t*t:(4-2*t)*t-1},a.easeInCubic=function(t){return t*t*t},a.easeOutCubic=function(t){var e=t-1;return e*e*e+1},a.easeInOutCubic=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},a.easeInQuart=function(t){return t*t*t*t},a.easeOutQuart=function(t){var e=t-1;return 1-e*e*e*e},a.easeInOutQuart=function(t){if(t<.5)return 8*t*t*t*t;var e=t-1;return 1-8*e*e*e*e},a.easeInQuint=function(t){return t*t*t*t*t},a.easeOutQuint=function(t){var e=t-1;return 1+e*e*e*e*e},a.easeInOutQuint=function(t){if(t<.5)return 16*t*t*t*t*t;var e=t-1;return 1+16*e*e*e*e*e},a.easeInExpo=function(t){return 0===t?0:Math.pow(2,10*(t-1))},a.easeOutExpo=function(t){return 1===t?1:1-Math.pow(2,-10*t)},a.easeInOutExpo=function(t){if(0===t||1===t)return t;var e=2*t-1;return e<0?.5*Math.pow(2,10*e):.5*(2-Math.pow(2,-10*e))},a.easeInCirc=function(t){return-1*(Math.sqrt(1-t*t)-1)},a.easeOutCirc=function(t){var e=t-1;return Math.sqrt(1-e*e)},a.easeInOutCirc=function(t){var e=2*t;if(e<1)return-.5*(Math.sqrt(1-e*e)-1);var n=e-2;return.5*(Math.sqrt(1-n*n)+1)},a.easeInBack=function(t,e){return t*t*(((e=e||1.70158)+1)*t-e)},a.easeOutBack=function(t,e){var n=t-1;return n*n*(((e=e||1.70158)+1)*n+e)+1},a.easeInOutBack=function(t,e){var n=2*t,i=1.525*(e=e||1.70158);if(n<1)return.5*n*n*((1+i)*n-i);var r=n-2;return.5*(r*r*((1+i)*r+i)+2)},a.easeInElastic=function(t,e){if(0===t||1===t)return t;var n=t-1,i=1-(e=e||.7),r=i/(2*Math.PI)*Math.asin(1);return-(Math.pow(2,10*n)*Math.sin((n-r)*(2*Math.PI)/i))},a.easeOutElastic=function(t,e){if(0===t||1===t)return t;var n=1-(e=e||.7),i=2*t,r=n/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*i)*Math.sin((i-r)*(2*Math.PI)/n)+1},a.easeInOutElastic=function(t,e){if(0===t||1===t)return t;var n=1-(e=e||.65),i=2*t-1,r=n/(2*Math.PI)*Math.asin(1);return i<0?Math.pow(2,10*i)*Math.sin((i-r)*(2*Math.PI)/n)*-.5:Math.pow(2,-10*i)*Math.sin((i-r)*(2*Math.PI)/n)*.5+1},a.easeOutBounce=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(e=t-1.5/2.75)*e+.75:t<2.5/2.75?7.5625*(e=t-2.25/2.75)*e+.9375:7.5625*(e=t-2.625/2.75)*e+.984375;var e},a.easeInBounce=function(t){return 1-a.easeOutBounce(1-t)},a.easeInOutBounce=function(t){return t<.5?.5*a.easeInBounce(2*t):.5*a.easeOutBounce(2*t-1)+.5},a);function a(){}var c=(f.getProgress=function(t,e,n,i){return Math.max(Math.min((t-e)*i/n,1),0)},f.getStartTime=function(t,e,n){return performance.now()-Math.round(e*t/n)},f.getDimensions=function(t){if(t&&Array.isArray(t)&&0<t.length){if("number"==typeof t[0])return 0;if(Array.isArray(t[0])&&0<t[0].length){if("number"==typeof t[0][0])return 1;if(Array.isArray(t[0][0])&&0<t[0][0].length){if("number"==typeof t[0][0][0])return 2;if(Array.isArray(t[0][0][0])&&0<t[0][0][0].length&&"number"==typeof t[0][0][0][0])return 3}}}return-1},f.getSuitableCoordinates=function(t,e){var n="Point";if(t instanceof g.Shape&&(n=t.getType()),e){var i=f.getDimensions(e);switch(n){case"Point":switch(i){case 0:return e;case 1:return e[0];case 2:return e[0][0];case 3:return e[0][0][0]}break;case"MultiPoint":case"LineString":switch(i){case 0:return"MultiPoint"===n?[e]:[e,e];case 1:return e;case 2:return e[0];case 3:return e[0][0]}break;case"MultiLineString":case"Polygon":switch(i){case 0:return[[e,e,e]];case 1:return[e];case 2:return e;case 3:return e[0]}break;case"MultiPolygon":switch(i){case 0:return[[[e,e,e]]];case 1:return[[e]];case 2:return[e];case 3:return e}}}return null},f.getPixelHeading=function(t,e){var n=(e[0]-t[0])*Math.PI/180,i=(t[1]-e[1])*Math.PI/180;return 180*(2.5*Math.PI-Math.atan2(i,n))/Math.PI%360},f.getPixelDestination=function(t,e,n){return[t[0]+n*Math.cos((e+270)*Math.PI/180),t[1]+n*Math.sin((e+270)*Math.PI/180)]},f.setMetadata=function(t,e){t&&e&&(t instanceof g.Shape?t.setProperties(Object.assign(t.getProperties(),e)):t instanceof g.HtmlMarker&&(t.metadata=Object.assign(t.metadata||{},e)))},f.setCoordinates=function(t,e,n){if(t)if(t instanceof g.Shape)switch(t.getType()){case"Point":t.setCoordinates(e);break;case"LineString":n&&t.setCoordinates(n)}else t instanceof g.HtmlMarker&&t.setOptions({position:e})},f.getPropertyPath=function(t){return t.split("/")},f.setValue=function(t,e,n){if(1<e.length){var i=e.shift();f.setValue(t[i]="[object Object]"===Object.prototype.toString.call(t[i])?t[i]:{},e,n)}else t[e[0]]=n},f.getValue=function(t,e){var n=e.length;if(0<n&&t){var i=t[e[0]];if(null!=i){var r=void 0;for(r=1;r<n&&null!=(i=i[e[r]]);r++);if(r===n&&null!=i)return i}}return null},f.interpolateValue=function(t,e,n,i,r){if(t&&e&&i){i.interpolation=i.interpolation||"linear";var s=f.getPropertyPath(i.propertyPath),o=f.getValue(t.properties,s),a=f.getValue(e.properties,s),h=typeof o,u=typeof a;if("undefined"!=h&&"undefined"!=u&&h==u){var p,l=void 0;if(o instanceof Date&&(o=o.getTime(),l="Date"),a instanceof Date&&(a=a.getTime(),"Date"!==l))return null;if("number"==h&&"number"==u)switch(i.interpolation){case"linear":p=o+(a-o)*n;break;case"min":p=Math.min(o,a);break;case"max":p=Math.max(o,a);break;case"avg":p=.5*(o+a)}else"nearest"===i.interpolation&&(p=n<.5?o:a);void 0!==p&&("Date"===l&&(p=new Date(p)),f.setValue(r,s,p))}}return null},f.extractRoutePointsFromFeature=function(t,e){var n,i,r=[];switch(t.geometry.type){case"Point":(n=f.extractRoutePointFromPoint(t,e))&&(r=[n]);break;case"LineString":case"MultiPoint":if(t.properties[e]&&Array.isArray(t.properties[e])&&t.geometry.coordinates.length===t.properties[e])for(var s=0,o=t.geometry.coordinates.length;s<o;s++)(i=g.math.parseTimestamp(t.properties[e]))&&r.push(new g.data.Feature(new g.data.Point(t.geometry.coordinates[s]),{_timestamp:i.getTime()}));else if(t.properties.waypoints&&Array.isArray(t.properties.waypoints)&&t.geometry.coordinates.length===t.properties.waypoints.length&&0<t.properties.waypoints.length&&t.properties.waypoints[0].geometry)for(s=0,o=t.geometry.coordinates.length;s<o;s++)"Point"===t.properties.waypoints[s].geometry.type&&(n=f.extractRoutePointFromPoint(t.properties.waypoints[s],e))&&r.push(n)}return 0<r.length?r:null},f.extractRoutePointFromPoint=function(t,e){if(t.properties[e]){var n=g.math.parseTimestamp(t.properties[e]);if(void 0!==n)return t.properties._timestamp=n.getTime(),t}return null},f);function f(){}var h=(u.prototype.disable=function(){this.stopped||(this.stopped=!0,cancelAnimationFrame(this._animation))},u.prototype.enable=function(){this.stopped&&(this.stopped=!1,this._animation=requestAnimationFrame(this.animate.bind(this)))},u.prototype.add=function(t){return t._id||(t._id=this._getUuid()),this._idLookupTable[t._id]||(this._queue.push(t),this._idLookupTable[t._id]=t),t._id},u.prototype.getById=function(t){return this._idLookupTable[t]},u.prototype.remove=function(t){if(t&&this._idLookupTable[t._id])for(var e=this._queue.length-1;0<=e;e--)if(t._id===this._queue[e]._id){this._queue=this._queue.splice(e,1),this._idLookupTable[t._id]=void 0;break}},u.prototype.removeById=function(t){this.remove(this._idLookupTable[t])},u.prototype.animate=function(){if(!this.stopped){var t=performance.now();if(t-this._lastTime>=this._minFrameRate){for(var e=this._queue.length-1;0<=e;e--)try{this._queue[e]._onAnimationProgress(t)}catch(t){}this._lastTime=t}this._animation=requestAnimationFrame(this.animate.bind(this))}},u.prototype._getUuid=function(){return this._idCounter++},u.instance=new u,u);function u(){this._animation=null,this._queue=[],this._minFrameRate=33,this.stopped=!0,this._idCounter=1234567890,this._idLookupTable={},this._lastTime=performance.now(),this.enable()}var p,l=(e(y,p=g.internal.EventEmitter),y.prototype.dispose=function(){this.stop(),h.instance.remove(this),this._options=null,this._easing=null,this._start=null,this._onComplete=null,this._id=void 0,this._rawProgress=null},y.prototype.getDuration=function(){return this._options.loop?1/0:this._options.duration/this._options.speedMultiplier},y.prototype.getOptions=function(){return Object.assign({},this._options)},y.prototype.isPlaying=function(){return null!==this._start},y.prototype.play=function(){1<=this._rawProgress&&(this._rawProgress=0),0<this._rawProgress?this._start=c.getStartTime(this._rawProgress,this._options.duration,this._options.speedMultiplier):this._start=performance.now()},y.prototype.pause=function(){this._start=null},y.prototype.seek=function(t){if("number"==typeof t){var e=this.isPlaying();e&&this.pause(),this._rawProgress=Math.min(Math.max(t,0),1)/this._options.speedMultiplier,this._processFrame(),e&&this.play()}},y.prototype.setOptions=function(t){if(t){t.easing&&("string"==typeof t.easing&&s[t.easing]?(this._easing=s[t.easing],this._options.easing=t.easing):t.easing instanceof Function&&(this._easing=t.easing,this._options.easing=t.easing)),"boolean"==typeof t.loop&&(this._options.loop=t.loop),"boolean"==typeof t.disposeOnComplete&&(this._options.disposeOnComplete=t.disposeOnComplete),"boolean"==typeof t.reverse&&(this._options.reverse=t.reverse),"number"==typeof t.speedMultiplier&&0<t.speedMultiplier&&(this._options.speedMultiplier=t.speedMultiplier);var e="number"==typeof t.duration&&0<t.duration&&this._options.duration!==t.duration,n="boolean"==typeof t.autoPlay;if(e||n){var i=this.isPlaying();i&&this.pause(),n&&(this._options.autoPlay=t.autoPlay||this._options.autoPlay,!i&&t.autoPlay&&(i=!0)),e&&(this._options.duration=t.duration||this._options.duration),i&&this.play()}}},y.prototype.stop=function(){this._rawProgress=1,this._processFrame(),this._start=null},y.prototype.reset=function(){this._start=null,this._rawProgress=0,this._processFrame()},y.prototype._onAnimationProgress=function(t){this._start&&(this._rawProgress=c.getProgress(t,this._start,this._options.duration,this._options.speedMultiplier),this._processFrame())},y.prototype._processFrame=function(){if(void 0!==this._id){var t=this._rawProgress||0;1<=this._rawProgress&&(this._options.loop?(this._rawProgress=0,this._start=performance.now()):(this._rawProgress=1,this._start=null,this._onComplete&&this._onComplete()));var e=this._options.reverse?1-this._rawProgress:this._rawProgress;this._easing&&(t=this._easing(e));var n=this.onAnimationProgress(t),i=Object.assign({progress:e,easingProgress:t,animation:this},n||{});this._invokeEvent("onprogress",Object.assign({type:"onprogress"},i)),null===this._start&&this._invokeEvent("oncomplete",Object.assign({type:"oncomplete"},i)),this._options.disposeOnComplete&&this.dispose()}},y);function y(t){var e=p.call(this)||this;return e._start=null,e._rawProgress=0,e._options={duration:1e3,autoPlay:!1,easing:"linear",loop:!1,reverse:!1,speedMultiplier:1,disposeOnComplete:!1},e._easing=s.linear,e._id=h.instance.add(e),e.setOptions(t),e}var _,m=(e(v,_=l),v.prototype.getCurrentFrameIdx=function(){return this._numberOfFrames<=0?-1:this._currentFrameIdx},v.prototype.getNumberOfFrames=function(){return this._numberOfFrames},v.prototype.setFrameIdx=function(t){(0<=t||t<this._numberOfFrames)&&this.seek(this._numberOfFrames/t)},v.prototype.setNumberOfFrames=function(t){"number"==typeof t&&this._numberOfFrames!==t&&(this._numberOfFrames=Math.max(t,0),this._currentFrameIdx=t<this._currentFrameIdx?this._currentFrameIdx:0,t<=0&&(this._currentFrameIdx=-1),this._triggerFrame(this._currentFrameIdx))},v.prototype.onAnimationProgress=function(t){if(0<this._numberOfFrames){var e=Math.round(t*this._numberOfFrames-.5);if(e!==this._currentFrameIdx)return e===this._numberOfFrames?e--:e<0&&(e=-1),this._triggerFrame(e),{frameIdx:e}}return null},v.prototype._triggerFrame=function(t){this._onFrame&&-1!==t&&this._onFrame(t),-1!==(this._currentFrameIdx=t)&&this._invokeEvent("onframe",{type:"onFrame",frameIdx:t,animation:this,numFrames:this._numberOfFrames})},v);function v(t,e,n){var i=_.call(this,n)||this;return i._numberOfFrames=0,i._currentFrameIdx=-1,i._numberOfFrames=t,i._onFrame=e,n&&n.autoPlay&&i.play(),i}var d,x=(e(P,d=g.layer.Layer),P.prototype.dispose=function(){this._animation.stop(),h.instance.remove(this),h.instance.remove(this._animation),this._animation=void 0,this._onComplete=void 0,this._id=void 0,this._options=void 0},P.prototype.getDuration=function(){return this._options.loop?1/0:this._options.duration},P.prototype.getOptions=function(){return Object.assign({},this._options,this._animation.getOptions())},P.prototype.getPlayableAnimation=function(){return this._animation},P.prototype.isPlaying=function(){return this._animation.isPlaying()},P.prototype.pause=function(){this._animation.pause()},P.prototype.play=function(){this._animation.play()},P.prototype.reset=function(){this._animation.reset()},P.prototype.stop=function(){this._animation.stop()},P.prototype.setFrameIdx=function(t){this._animation.setFrameIdx(t)},P.prototype.setOptions=function(t){var e=this;if(t.tileLayerOptions&&(0<this._tileLayers.length&&(this._map&&this._map.layers.remove(this._tileLayers),this._tileLayers=[],this._currentTileLayer=null),t.tileLayerOptions.forEach(function(t){t.fadeDuration=0,t.visible=!0,e._tileLayers.push(new g.layer.TileLayer(Object.assign({},t,{opacity:0})))}),this._map&&this._map.layers.add(this._tileLayers,this),this._options.tileLayerOptions=t.tileLayerOptions,this._animation&&this._animation.setNumberOfFrames(this._options.tileLayerOptions.length),0<=(n=this._animation?this._animation.getCurrentFrameIdx():0)&&(this._currentTileLayer=this._tileLayers[n],this._currentTileLayer.setOptions({fadeDuration:0,visible:!0}))),"boolean"==typeof t.visible)if(this._options.visible=t.visible,t.visible){var n=this._animation.getCurrentFrameIdx();0<t.tileLayerOptions.length&&this._currentTileLayer.setOptions({fadeDuration:0,opacity:t.tileLayerOptions[n].opacity})}else this._tileLayers.forEach(function(t){return t.setOptions({opacity:0})});if(this._animation){var i=!1;Object.keys(t).forEach(function(t){switch(t){case"tileLayerOptions":case"visible":break;default:i=!0}}),i&&this._animation.setOptions(t)}},P.prototype.onAdd=function(t){this._map=t,this._map.layers.add(this._tileLayers,this)},P.prototype.onRemove=function(){this._map.layers.remove(this._tileLayers),this._map=null},P.prototype._buildLayers=function(){return[]},P.prototype._getLayerIds=function(){return[this.id]},P.prototype._buildSource=function(){return null},P.prototype._getSourceId=function(){return null},P.prototype._onAnimationProgress=function(t){return null},P);function P(t){var e=d.call(this)||this;e._tileLayers=[],e._options={tileLayerOptions:[],visible:!0},e._onFrame=function(t){e._options.visible&&e._options.tileLayerOptions&&0<e._options.tileLayerOptions.length&&t<e._options.tileLayerOptions.length&&(e._currentTileLayer&&(e._map.map.setPaintProperty(e._currentTileLayer.getId(),"raster-opacity-transition",{duration:0,delay:0}),e._map.map.setPaintProperty(e._currentTileLayer.getId(),"raster-opacity",0)),e._currentTileLayer=e._tileLayers[t],e._map.map.setPaintProperty(e._currentTileLayer.getId(),"raster-opacity-transition",{duration:0,delay:0}),e._map.map.setPaintProperty(e._currentTileLayer.getId(),"raster-opacity",e._options.tileLayerOptions[t].opacity))},e._id=h.instance.add(e);var n=0;return t&&(e.setOptions(t),t.tileLayerOptions&&(n=t.tileLayerOptions.length)),e._animation=new m(n,e._onFrame,t),e._onComplete=e._animation._onComplete,e}var M,b=Object.freeze({__proto__:null,AnimatedTileLayer:x}),w=(e(O,M=l),O.prototype.onAnimationProgress=function(t){for(var e,n=0,i=this._shapes.length;n<i;n++){var r=this._y0[n]-this._height*(1-t);if(e=[this._x0[n],r],this._shapes[n]instanceof g.Shape){var s=this._shapes[n];s.setProperties(Object.assign(s.getProperties(),{offset:e,opacity:0!==t?1:0}))}else this._shapes[n].setOptions({pixelOffset:e,visible:0!==t})}return null},O);function O(t,e,n,i){var r=M.call(this,i)||this;if(r._height=200,!(t&&0<t.length))throw"No shape specified for animation.";r._shapes=t,r._x0=[],r._y0=[],r._height="number"==typeof n&&0<n?n:r._height;var s,o,a,h=[],u=[];e instanceof g.source.DataSource&&(o=e),e instanceof g.Map&&(u=(a=e).markers.getMarkers());for(var p=0,l=r._shapes.length;p<l;p++){if(s=null,r._shapes[p]instanceof g.Shape)s=r._shapes[p].getProperties().offset;else s=r._shapes[p].getOptions().pixelOffset;if(s&&Array.isArray(s)&&2<=s.length?(r._x0.push(s[0]),r._y0.push(s[1])):(r._x0.push(0),r._y0.push(0),s=[0,0]),s[1]-=r._height,r._shapes[p]instanceof g.Shape){var c=r._shapes[p];c.setProperties(Object.assign(c.getProperties(),{offset:s,opacity:0})),o&&null===o.getShapeById(r._shapes[p].getId())&&h.push(r._shapes[p])}else{var f=r._shapes[p];f.setOptions({pixelOffset:s,visible:!1}),a&&u&&-1===u.indexOf(f)&&a.markers.add(f)}}return o&&0<h.length&&o.add(h),i&&i.autoPlay&&r.play(),r}var L,A=(e(I,L=l),I.prototype.dispose=function(){this._pathOptions=null,L.prototype.dispose.call(this)},I.prototype.getOptions=function(){return Object.assign({},L.prototype.getOptions.call(this),this._pathOptions)},I.prototype.setOptions=function(t){t&&("number"==typeof t.duration&&0<t.duration&&(this._pathOptions.duration=t.duration||this._pathOptions.duration),"boolean"==typeof t.captureMetadata&&(this._pathOptions.captureMetadata=t.captureMetadata),"boolean"==typeof t.geodesic&&(this._pathOptions.geodesic=t.geodesic),"boolean"==typeof t.reverse&&(this._pathOptions.reverse=t.reverse),"number"==typeof t.pitch&&(this._pathOptions.pitch=t.pitch),"number"==typeof t.zoom&&(this._pathOptions.zoom=t.zoom),"boolean"==typeof t.rotate&&(this._pathOptions.rotate=t.rotate),"number"==typeof t.rotationOffset&&(this._pathOptions.rotationOffset=t.rotationOffset),!t.map&&null!==t.map||(this._pathOptions.map=t.map),L.prototype.setOptions.call(this,t))},I.prototype._setMapCamera=function(t,e,n){if(this._pathOptions.map&&t){var i={center:t};"number"==typeof this._pathOptions.pitch&&(i.pitch=this._pathOptions.pitch),"number"==typeof this._pathOptions.zoom&&(i.zoom=this._pathOptions.zoom),this._pathOptions.rotate&&"number"==typeof e&&(i.bearing=this._pathOptions.reverse?e+180:e,"number"==typeof this._pathOptions.rotationOffset&&(i.bearing+=this._pathOptions.rotationOffset)),n?(i.type="fly",i.duration=Math.min(60,this._pathOptions.duration)):i.type="jump",this._pathOptions.map.setCamera(i)}},I.prototype.onAnimationProgress=function(t){return null},I);function I(t){var e=L.call(this,t)||this;return e._pathOptions={duration:1e3},e.setOptions(t),e}var k,C=(e(T,k=A),T.prototype.setOptions=function(t){if(t&&k.prototype.setOptions.call(this,t),this._originPosition&&this._destinationPosition){if(this._pathOptions.geodesic)this._dx=g.math.getDistanceTo(this._originPosition,this._destinationPosition),this._heading=g.math.getHeading(this._originPosition,this._destinationPosition);else{var e=g.math.mercatorPositionsToPixels([this._originPosition,this._destinationPosition],21);if(this._originPixel=e[0],180<Math.abs(this._originPosition[0]-this._destinationPosition[0])){var n=512*Math.pow(2,21);e[0][0]>e[1][0]?e[1][0]+=n:e[0][0]+=n}this._dx=g.Pixel.getDistance(e[0],e[1]),this._heading=g.Pixel.getHeading(e[0],e[1])}this._pathOptions.captureMetadata&&c.setMetadata(this._shape,{heading:this._heading})}},T.prototype.onAnimationProgress=function(t){if(this._originPosition&&this._destinationPosition&&this._pathOptions){var e,n=!1;if(1===t)e=this._destinationPosition;else if(0===t)e=this._originPosition;else{var i=this._dx*t;e=this._pathOptions.geodesic?g.math.getDestination(this._originPosition,this._heading,i):g.math.mercatorPixelsToPositions([g.Pixel.getDestination(this._originPixel,this._heading,i)],21)[0],n=!0}return c.setCoordinates(this._shape,e),this._pathOptions.map&&this._setMapCamera(e,this._heading,n),{position:e,heading:this._heading}}return null},T);function T(t,e,n){var i=k.call(this)||this;return t instanceof g.Shape?i._originPosition=t.getCoordinates():i._originPosition=t.getOptions().position,i._shape=t,i._destinationPosition=e,i.setOptions(n),n&&n.autoPlay&&i.play(),i}var S,F=(e(q,S=A),q.prototype.dispose=function(){this._totalLength=null,this._positions=null,this._pixels=null,this._distances=null,this._headings=null,this._shape=null,S.prototype.dispose.call(this)},q.prototype.setOptions=function(t){t&&S.prototype.setOptions.call(this,t);var e=this.isPlaying();if(e&&this.pause(),this._positions){if(this._totalLength=0,this._distances=[],this._headings=[],this._pathOptions.geodesic)for(var n=1,i=this._positions.length;n<i;n++){var r=g.math.getDistanceTo(this._positions[n-1],this._positions[n]);this._totalLength+=r,this._distances.push(r);var s=g.math.getHeading(this._positions[n-1],this._positions[n]);this._headings.push(s)}else for(this._pixels=g.math.mercatorPositionsToPixels(this._positions,21),n=1,i=this._pixels.length;n<i;n++)r=g.Pixel.getDistance(this._pixels[n-1],this._pixels[n]),this._totalLength+=r,this._distances.push(r),s=c.getPixelHeading(this._pixels[n-1],this._pixels[n]),this._headings.push(s);this._pathOptions.captureMetadata&&c.setMetadata(this._shape,{heading:this._headings[0]})}e&&this.play()},q.prototype.onAnimationProgress=function(t){var e,n;if(1===t)e=this._positions[this._positions.length-1],n=0<this._headings.length?this._headings[this._headings.length-1]:void 0,this._pathOptions.map&&this._setMapCamera(e,n,!1),c.setCoordinates(this._shape,e,r);else if(0===t)e=this._positions[0],n=0<this._headings.length?this._headings[0]:void 0,this._pathOptions.map&&this._setMapCamera(e,n,!1),c.setCoordinates(this._shape,e,[e,e]);else{var i=this._totalLength*t,r=null;if(this._pathOptions.geodesic)if(i>this._totalLength)n=this._headings[this._headings.length-1],r=this._positions.slice(0);else if(i<0)n=this._headings[0],r=this._positions.slice(0,1);else for(var s=0,o=0;o<this._distances.length;o++){if(s+this._distances[o]>=i){n=this._headings[o],(r=this._positions.slice(0,o+1)).push(g.math.getDestination(this._positions[o],n,i-s));break}s+=this._distances[o]}else{var a=null;if(i>this._totalLength)n=this._headings[this._headings.length-1],a=c.getPixelDestination(this._pixels[this._pixels.length-1],n,i-this._totalLength),(r=this._positions.slice(0)).push(g.math.mercatorPixelsToPositions([a],21)[0]);else if(i<0)n=this._headings[0],a=c.getPixelDestination(this._pixels[0],n,i),(r=this._positions.slice(0,1)).push(g.math.mercatorPixelsToPositions([a],21)[0]);else for(o=s=0;o<this._distances.length;o++){if(s+this._distances[o]>=i){n=this._headings[o],a=c.getPixelDestination(this._pixels[o],n,i-s),(r=this._positions.slice(0,o+1)).push(g.math.mercatorPixelsToPositions([a],21)[0]);break}s+=this._distances[o]}}r&&0<r.length&&(e=r[r.length-1],this._pathOptions.map&&this._setMapCamera(e,n,2<r.length),c.setCoordinates(this._shape,e,r))}return this._pathOptions.captureMetadata&&c.setMetadata(this._shape,{heading:n}),{position:e,heading:n}},q);function q(t,e,n){var i=S.call(this)||this;return i._shape=e,i._positions=t,i.setOptions(Object.assign({rotate:!0,rotationOffset:0},n||{})),n&&n.autoPlay&&i.play(),i}var E,G,D=(function(t){!function(t){function e(t){return 10===t||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&re.indexOf(t)>=0}function o(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}function u(t){return t>=48&&t<=57}function a(t){return t>=48&&t<=57||43===t||45===t||46===t}function i(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function h(t){for(;t.index<t.max&&e(t.path.charCodeAt(t.index));)t.index++}function p(t){var e,n=t.index,i=n,r=t.max,s=!1,o=!1,a=!1,h=!1;if(i>=r)return void(t.err="SvgPath: missed param (at pos "+i+")");if(e=t.path.charCodeAt(i),43!==e&&45!==e||(i++,e=i<r?t.path.charCodeAt(i):0),!u(e)&&46!==e)return void(t.err="SvgPath: param should start with 0..9 or `.` (at pos "+i+")");if(46!==e){if(s=48===e,i++,e=i<r?t.path.charCodeAt(i):0,s&&i<r&&e&&u(e))return void(t.err="SvgPath: numbers started with `0` such as `09` are ilegal (at pos "+n+")");for(;i<r&&u(t.path.charCodeAt(i));)i++,o=!0;e=i<r?t.path.charCodeAt(i):0}if(46===e){for(h=!0,i++;u(t.path.charCodeAt(i));)i++,a=!0;e=i<r?t.path.charCodeAt(i):0}if(101===e||69===e){if(h&&!o&&!a)return void(t.err="SvgPath: invalid float exponent (at pos "+i+")");if(i++,e=i<r?t.path.charCodeAt(i):0,43!==e&&45!==e||i++,!(i<r&&u(t.path.charCodeAt(i))))return void(t.err="SvgPath: invalid float exponent (at pos "+i+")");for(;i<r&&u(t.path.charCodeAt(i));)i++}t.index=i,t.param=parseFloat(t.path.slice(n,i))+0}function l(t){var e,n;e=t.path[t.segmentStart],n=e.toLowerCase();var i=t.data;if("m"===n&&i.length>2&&(t.result.push([e,i[0],i[1]]),i=i.slice(2),n="l",e="m"===e?"l":"L"),"r"===n)t.result.push([e].concat(i));else for(;i.length>=ie[n]&&(t.result.push([e].concat(i.splice(0,ie[n]))),ie[n]););}function r(t){var e,n,i,r,s=t.max;if(t.segmentStart=t.index,e=t.path.charCodeAt(t.index),!o(e))return void(t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")");if(i=ie[t.path[t.index].toLowerCase()],t.index++,h(t),t.data=[],!i)return void l(t);for(n=!1;;){for(r=i;r>0;r--){if(p(t),t.err.length)return;t.data.push(t.param),h(t),n=!1,t.index<s&&44===t.path.charCodeAt(t.index)&&(t.index++,h(t),n=!0)}if(!n){if(t.index>=t.max)break;if(!a(t.path.charCodeAt(t.index)))break}}l(t)}function n(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}function s(){if(!(this instanceof s))return new s;this.queue=[],this.cache=null}function A(t,e,n,i){var r=t*i-e*n<0?-1:1,s=Math.sqrt(t*t+e*e),o=Math.sqrt(t*t+e*e),a=t*n+e*i,h=a/(s*o);return h>1&&(h=1),h<-1&&(h=-1),r*Math.acos(h)}function x(t,e,n,i,r,s,o,a,h,u){var p=u*(t-n)/2+h*(e-i)/2,l=-h*(t-n)/2+u*(e-i)/2,c=o*o,f=a*a,g=p*p,y=l*l,_=c*f-c*y-f*g;_<0&&(_=0),_/=c*y+f*g,_=Math.sqrt(_)*(r===s?-1:1);var m=_*o/a*l,v=_*-a/o*p,d=u*m-h*v+(t+n)/2,x=h*m+u*v+(e+i)/2,P=(p-m)/o,M=(l-v)/a,b=(-p-m)/o,w=(-l-v)/a,O=A(1,0,P,M),L=A(P,M,b,w);return 0===s&&L>0&&(L-=le),1===s&&L<0&&(L+=le),[d,x,O,L]}function P(t,e){var n=4/3*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[i,r,i-r*n,r+i*n,s+o*n,o-s*n,s,o]}function c(t,e,n){if(!(this instanceof c))return new c(t,e,n);this.rx=t,this.ry=e,this.ax=n}function f(t){if(!(this instanceof f))return new f(t);var e=se(t);this.segments=e.segments,this.err=e.err,this.__stack=[]}function g(t){var e=t.match(xe);return e?e.map(Number):[]}function y(t,e,n,i,r,s,o,a){this.a={x:t,y:e},this.b={x:n,y:i},this.c={x:r,y:s},this.d={x:o,y:a},null!==o&&void 0!==o&&null!==a&&void 0!==a?(this.getArcLength=I,this.getPoint=M,this.getDerivative=m):(this.getArcLength=b,this.getPoint=d,this.getDerivative=_),this.init()}function _(t,e,n){return{x:2*(1-n)*(t[1]-t[0])+2*n*(t[2]-t[1]),y:2*(1-n)*(e[1]-e[0])+2*n*(e[2]-e[1])}}function m(t,e,n){return d([3*(t[1]-t[0]),3*(t[2]-t[1]),3*(t[3]-t[2])],[3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],n)}function v(t,e,n,i,r){for(var s=1,o=t/e,a=(t-n(i,r,o))/e;s>.001;){var h=n(i,r,o+a),u=n(i,r,o-a),p=Math.abs(t-h)/e,l=Math.abs(t-u)/e;p<s?(s=p,o+=a):l<s?(s=l,o-=a):a/=2}return o}function d(t,e,n){return{x:(1-n)*(1-n)*t[0]+2*(1-n)*n*t[1]+n*n*t[2],y:(1-n)*(1-n)*e[0]+2*(1-n)*n*e[1]+n*n*e[2]}}function M(t,e,n){return{x:(1-n)*(1-n)*(1-n)*t[0]+3*(1-n)*(1-n)*n*t[1]+3*(1-n)*n*n*t[2]+n*n*n*t[3],y:(1-n)*(1-n)*(1-n)*e[0]+3*(1-n)*(1-n)*n*e[1]+3*(1-n)*n*n*e[2]+n*n*n*e[3]}}function b(t,e,n){void 0===n&&(n=1);var i=t[0]-2*t[1]+t[2],r=e[0]-2*e[1]+e[2],s=2*t[1]-2*t[0],o=2*e[1]-2*e[0],a=4*(i*i+r*r),h=4*(i*s+r*o),u=s*s+o*o;if(0===a)return n*Math.sqrt(Math.pow(t[2]-t[0],2)+Math.pow(e[2]-e[0],2));var p=h/(2*a),l=u/a,c=n+p,f=l-p*p;return Math.sqrt(a)/2*(c*Math.sqrt(c*c+f)-p*Math.sqrt(p*p+f)+f*Math.log(Math.abs((c+Math.sqrt(c*c+f))/(p+Math.sqrt(p*p+f)))))}function w(t,e){return we[t][e]}function O(t,e,n){var i,r,s,o=n.length-1;if(0===o)return 0;if(0===t){for(r=0,s=0;s<=o;s++)r+=w(o,s)*Math.pow(1-e,o-s)*Math.pow(e,s)*n[s];return r}for(i=new Array(o),s=0;s<o;s++)i[s]=o*(n[s+1]-n[s]);return O(t-1,e,i)}function L(t,e,n){var i=O(1,n,t),r=O(1,n,e),s=i*i+r*r;return Math.sqrt(s)}function I(t,e,n){var i,r,s,o;void 0===n&&(n=1);for(i=n/2,r=0,s=0;s<20;s++)o=i*Me[20][s]+i,r+=be[20][s]*L(t,e,o);return i*r}function k(t,e,n,i){var r=t*i-e*n<0?-1:1,s=t*n+e*i;return s>1&&(s=1),s<-1&&(s=-1),r*Math.acos(s)}function C(t,e,n,i,r,s,o,a,h,u){var p=u*(t-n)/2+h*(e-i)/2,l=-h*(t-n)/2+u*(e-i)/2,c=o*o,f=a*a,g=p*p,y=l*l,_=c*f-c*y-f*g;_<0&&(_=0),_/=c*y+f*g,_=Math.sqrt(_)*(r===s?-1:1);var m=_*o/a*l,v=_*-a/o*p,d=u*m-h*v+(t+n)/2,x=h*m+u*v+(e+i)/2,P=(p-m)/o,M=(l-v)/a,b=(-p-m)/o,w=(-l-v)/a,O=k(1,0,P,M),L=k(P,M,b,w);return 0===s&&L>0&&(L-=Oe),1===s&&L<0&&(L+=Oe),[d,x,O,L]}function T(t,e){var n=4/3*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[i,r,i-r*n,r+i*n,s+o*n,o-s*n,s,o]}function S(t,e,n,i,r,s,o,a,h){var u=0,p=[],l=[];Le(t,e,n,i,r,s,o,a,h).forEach(function(t){var e=new Pe(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),n=e.getTotalLength();u+=n,p.push(n),l.push(e)}),this.length=u,this.partialLengths=p,this.curves=l}function F(t,e,n,i){this.x0=t,this.x1=e,this.y0=n,this.y1=i}function q(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function E(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function G(t,e){return q(t,e)<1e-9}function D(t,n,i){var r=t.map(function(t,e){return j(t,n[e])});return function(e){var t=r.map(function(t){return t(e)});return i?N(t):t}}function j(t,i){return function(n){return t.map(function(t,e){return t+n*(i[e]-t)})}}function Z(t){return"number"==typeof t&&isFinite(t)}function B(t){return z(t)?ee(t):[(t[0][0]+t[t.length-1][0])/2,(t[0][1]+t[t.length-1][1])/2]}function z(t){for(var e=0;e<t.length-2;e++){var n=t[e],i=t[e+1],r=t[e+2];if(n[0]*(i[1]-r[1])+i[0]*(r[1]-n[1])+r[0]*(n[1]-i[1]))return!0}return!1}function H(t){return new _e(t).abs()}function V(t){return t.toString().split("M").map(function(t,e){return t=t.trim(),e&&t?"M"+t:t}).filter(function(t){return t})}function N(t){return"M"+t.join("L")+"Z"}function R(t){return V(H(t))}function Q(t,e){var n=H(t);return J(n)||X(n,e)}function J(t){var e=t.segments||[],n=[];if(!e.length||"M"!==e[0][0])return!1;for(var i=0;i<e.length;i++){var r=e[i],s=r[0],o=r[1],a=r[2];if("M"===s&&i||"Z"===s)break;if("M"===s||"L"===s)n.push([o,a]);else if("H"===s)n.push([o,n[n.length-1][1]]);else{if("V"!==s)return!1;n.push([n[n.length-1][0],o])}}return!!n.length&&{ring:n}}function X(t,e){var n,i,r=V(t)[0],s=[],o=3;if(!r)throw new TypeError(Ce);i=Y(r),n=i.getTotalLength(),e&&Z(e)&&e>0&&(o=Math.max(o,Math.ceil(n/e)));for(var a=0;a<o;a++){var h=i.getPointAtLength(n*a/o);s.push([h.x,h.y])}return{ring:s,skipBisect:!0}}function Y(t){if("undefined"!=typeof window&&window&&window.document)try{var e=window.document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttributeNS(null,"d",t),e}catch(t){}return ke(t)}function U(t,e){for(var n=t.length+e,i=ne(t)/e,r=0,s=0,o=i/2;t.length<n;){var a=t[r],h=t[(r+1)%t.length],u=q(a,h);o<=s+u?(t.splice(r+1,0,u?E(a,h,(o-s)/u):a.slice(0)),o+=i):(s+=u,r++)}}function W(t,e){void 0===e&&(e=1/0);for(var n=0;n<t.length;n++)for(var i=t[n],r=n===t.length-1?t[0]:t[n+1];q(i,r)>e;)r=E(i,r,.5),t.splice(n+1,0,r)}function $(t,e){var n,i,r;if("string"==typeof t){var s=Q(t,e);t=s.ring,r=s.skipBisect}else if(!Array.isArray(t))throw new TypeError(Ce);if(n=t.slice(0),!K(n))throw new TypeError(Ce);return n.length>1&&G(n[0],n[n.length-1])&&n.pop(),i=te(n),i>0&&n.reverse(),!r&&e&&Z(e)&&e>0&&W(n,e),n}function K(t){return t.every(function(t){return Array.isArray(t)&&t.length>=2&&Z(t[0])&&Z(t[1])})}function tt(t,e,n){var i;return i=t.length-e.length,U(t,i<0?-1*i:0),U(e,i>0?i:0),Se(t,e),D(t,e,n)}function et(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,s=nt(t,0,r,n,!0),o=[];if(!s)return o;var a,h,u,p,l,c,f;if(i&&(s=ut(t,e,s,n)),t.length>80*n){a=u=t[0],h=p=t[1];for(var g=n;g<r;g+=n)l=t[g],c=t[g+1],l<a&&(a=l),c<h&&(h=c),l>u&&(u=l),c>p&&(p=c);f=Math.max(u-a,p-h)}return rt(s,o,n,a,h,f),o}function nt(t,e,n,i,r){var s,o;if(r===kt(t,e,n,i)>0)for(s=e;s<n;s+=i)o=Lt(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=Lt(s,t[s],t[s+1],o);return o&&xt(o,o.next)&&(At(o),o=o.next),o}function it(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!xt(i,i.next)&&0!==dt(i.prev,i,i.next))i=i.next;else{if(At(i),(i=e=i.prev)===i.next)return null;n=!0}}while(n||i!==e);return e}function rt(t,e,n,i,r,s,o){if(t){!o&&s&&ft(t,i,r,s);for(var a,h,u=t;t.prev!==t.next;)if(a=t.prev,h=t.next,s?ot(t,i,r,s):st(t))e.push(a.i/n),e.push(t.i/n),e.push(h.i/n),At(t),t=h.next,u=h.next;else if((t=h)===u){o?1===o?(t=at(t,e,n),rt(t,e,n,i,r,s,2)):2===o&&ht(t,e,n,i,r,s):rt(it(t),e,n,i,r,s,1);break}}}function st(t){var e=t.prev,n=t,i=t.next;if(dt(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(mt(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&dt(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function ot(t,e,n,i){var r=t.prev,s=t,o=t.next;if(dt(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,h=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,p=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,l=yt(a,h,e,n,i),c=yt(u,p,e,n,i),f=t.nextZ;f&&f.z<=c;){if(f!==t.prev&&f!==t.next&&mt(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&dt(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=l;){if(f!==t.prev&&f!==t.next&&mt(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&dt(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function at(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!xt(r,s)&&Pt(r,i,i.next,s)&&bt(r,s)&&bt(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),At(i),At(i.next),i=t=s),i=i.next}while(i!==t);return i}function ht(t,e,n,i,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&vt(o,a)){var h=Ot(o,a);return o=it(o,o.next),h=it(h,h.next),rt(o,e,n,i,r,s),void rt(h,e,n,i,r,s)}a=a.next}o=o.next}while(o!==t)}function ut(t,e,n,i){var r,s,o,a,h,u=[];for(r=0,s=e.length;r<s;r++)o=e[r]*i,a=r<s-1?e[r+1]*i:t.length,h=nt(t,o,a,i,!1),h===h.next&&(h.steiner=!0),u.push(_t(h));for(u.sort(pt),r=0;r<u.length;r++)lt(u[r],n),n=it(n,n.next);return n}function pt(t,e){return t.x-e.x}function lt(t,e){if(e=ct(t,e)){var n=Ot(e,t);it(n,n.next)}}function ct(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;var h,u=n,p=n.x,l=n.y,c=1/0;for(i=n.next;i!==u;)r>=i.x&&i.x>=p&&mt(s<l?r:o,s,p,l,s<l?o:r,s,i.x,i.y)&&((h=Math.abs(s-i.y)/(r-i.x))<c||h===c&&i.x>n.x)&&bt(i,t)&&(n=i,c=h),i=i.next;return n}function ft(t,e,n,i){var r=t;do{null===r.z&&(r.z=yt(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,gt(r)}function gt(t){var e,n,i,r,s,o,a,h,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0===a?(r=i,i=i.nextZ,h--):0!==h&&i?n.z<=i.z?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--):(r=n,n=n.nextZ,a--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1);return t}function yt(t,e,n,i,r){return t=32767*(t-n)/r,e=32767*(e-i)/r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function _t(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function mt(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function vt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Mt(t,e)&&bt(t,e)&&bt(e,t)&&wt(t,e)}function dt(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function xt(t,e){return t.x===e.x&&t.y===e.y}function Pt(t,e,n,i){return!!(xt(t,e)&&xt(n,i)||xt(t,i)&&xt(n,e))||dt(t,e,n)>0!=dt(t,e,i)>0&&dt(n,i,t)>0!=dt(n,i,e)>0}function Mt(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Pt(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function bt(t,e){return dt(t.prev,t,t.next)<0?dt(t,e,t.next)>=0&&dt(t,t.prev,e)>=0:dt(t,e,t.prev)<0||dt(t,t.next,e)<0}function wt(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function Ot(t,e){var n=new It(t.i,t.x,t.y),i=new It(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Lt(t,e,n,i){var r=new It(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function At(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function It(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function kt(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}function Ct(t,e){var n=e.id,i=e.bbox,r=null==e.properties?{}:e.properties,s=Tt(t,e);return null==n&&null==i?{type:"Feature",properties:r,geometry:s}:null==i?{type:"Feature",id:n,properties:r,geometry:s}:{type:"Feature",id:n,bbox:i,properties:r,geometry:s}}function Tt(t,e){function r(t,e){e.length&&e.pop();for(var n=u[t<0?~t:t],i=0,r=n.length;i<r;++i)e.push(h(n[i],i));t<0&&De(e,r)}function i(t){return h(t)}function s(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0]),e}function n(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function o(t){return t.map(n)}function a(t){var e,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(a)};case"Point":e=i(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(i);break;case"LineString":e=s(t.arcs);break;case"MultiLineString":e=t.arcs.map(s);break;case"Polygon":e=o(t.arcs);break;case"MultiPolygon":e=t.arcs.map(o);break;default:return null}return{type:n,coordinates:e}}var h=Ge(t.transform),u=t.arcs;return a(e)}function St(t){for(var e,n=-1,i=t.length,r=t[i-1],s=0;++n<i;)e=r,r=t[n],s+=e[0]*r[1]-e[1]*r[0];return Math.abs(s)}function Ft(a,t){function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":n(t.arcs);break;case"MultiPolygon":t.arcs.forEach(n)}}function n(e){e.forEach(function(t){t.forEach(function(t){(u[t=t<0?~t:t]||(u[t]=[])).push(e)})}),i.push(e)}function h(t){return St(Tt(a,{type:"Polygon",arcs:[t]}).coordinates[0])}var u={},i=[],r=[];return t.forEach(e),i.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,r.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),i.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:r.map(function(t){var e,n=[];if(t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].length<2&&n.push(t)})})}),n=Ze(a,n),(e=n.length)>1)for(var i,r,s=1,o=h(n[0]);s<e;++s)(i=h(n[s]))>o&&(r=n[0],n[0]=n[s],n[s]=r,o=i);return n})}}function qt(n){return function(t,e){return He(n(t),e)}}function Et(t,s){var o={},a={type:"Topology",objects:{triangles:{type:"GeometryCollection",geometries:[]}},arcs:[]};return t.forEach(function(t){var r=[];t.forEach(function(t,e){var n=t[0]<t[1]?t.join(","):t[1]+","+t[0],i=t.map(function(t){return s[t]});n in o?r.push(~o[n]):(r.push(o[n]=a.arcs.length),a.arcs.push(i))}),a.objects.triangles.geometries.push({type:"Polygon",area:Math.abs(te(t.map(function(t){return s[t[0]]}))),arcs:[r]})}),a.objects.triangles.geometries.sort(function(t,e){return t.area-e.area}),a}function Gt(r,t){for(var s=r.objects.triangles.geometries,o=Ve(function(t){return t.area}).left;s.length>t;)!function(){var t=s[0],e=ze(s)[0][0],n=s[e],i=Ft(r,[t,n]);i.area=t.area+n.area,i.type="Polygon",i.arcs=i.arcs[0],s.splice(e,1),s.shift(),s.splice(o(s,i.area),0,i)}();if(t>s.length)throw new RangeError("Can't collapse topology into "+t+" pieces.");return je(r,r.objects.triangles).features.map(function(t){return t.geometry.coordinates[0].pop(),t.geometry.coordinates[0]})}function Dt(t){for(var e=qe(t.reduce(function(t,e){return t.concat([e[0]],[e[1]])},[])),n=[],i=0,r=e.length;i<r;i+=3)n.push([[e[i],e[i+1]],[e[i+1],e[i+2]],[e[i+2],e[i]]]);return n}function jt(t,e,o){function a(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=0);for(var i=0;i<t.length;i++){var r=t.splice(i,1),s=o[r[0]][e.length];n+s<h&&(t.length?a(t.slice(),e.concat(r),n+s):(h=n+s,u=e.concat(r))),t.length&&t.splice(i,0,r[0])}}var h=1/0,u=t.map(function(t,e){return e});return a(u),u}function Zt(t,e){var n=q(B(t),B(e));return n*n}function Bt(t,e,n){void 0===n&&(n={});var i=n.maxSegmentLength;void 0===i&&(i=10);var r=n.string;void 0===r&&(r=!0);var s=n.single;void 0===s&&(s=!1);var o=$(t,i);o.length<e.length+2&&U(o,e.length+2-o.length);var a,h=Re(o,e.length),u=e.map(function(t){return $(t,i)}),p="string"==typeof t&&t;return s&&!e.every(function(t){return"string"==typeof t})||(a=e.slice(0)),Vt(h,u,{match:!0,string:r,single:s,t0:p,t1:a})}function zt(t,e,n){void 0===n&&(n={});var i=n.maxSegmentLength;void 0===i&&(i=10);var r=n.string;void 0===r&&(r=!0);var s=n.single;void 0===s&&(s=!1);var o=Bt(e,t,{maxSegmentLength:i,string:r,single:s});return s?function(t){return o(1-t)}:o.map(function(e){return function(t){return e(1-t)}})}function Ht(t,e,n){void 0===n&&(n={});var i=n.maxSegmentLength;void 0===i&&(i=10);var r=n.string;void 0===r&&(r=!0);var s=n.single;if(void 0===s&&(s=!1),!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length||!t.length)throw new TypeError(Te);var o,a,h=function(t){return $(t,i)},u=t.map(h),p=e.map(h);return s?(t.every(function(t){return"string"==typeof t})&&(o=t.slice(0)),e.every(function(t){return"string"==typeof t})&&(a=e.slice(0))):(o=t.slice(0),a=e.slice(0)),Vt(u,p,{string:r,single:s,t0:o,t1:a,match:!1})}function Vt(n,i,t){void 0===t&&(t={});var r=t.string,e=t.single,s=t.t0,o=t.t1,a=t.match,h=a?Qe(n,i):n.map(function(t,e){return e}),u=h.map(function(t,e){return tt(n[t],i[e],r)});if(a&&Array.isArray(s)&&(s=h.map(function(t){return s[t]})),e&&r&&(Array.isArray(s)&&(s=s.join(" ")),Array.isArray(o)&&(o=o.join(" "))),e){var p=r?function(e){return u.map(function(t){return t(e)}).join(" ")}:function(e){return u.map(function(t){return t(e)})};return r&&(s||o)?function(t){return t<1e-4&&s||1-t<1e-4&&o||p(t)}:p}return r?(s=Array.isArray(s)?s.map(function(t){return"string"==typeof t&&t}):[],o=Array.isArray(o)?o.map(function(t){return"string"==typeof t&&t}):[],u.map(function(e,n){return s[n]||o[n]?function(t){return t<1e-4&&s[n]||1-t<1e-4&&o[n]||e(t)}:e})):u}function Nt(t,e,n,i,r){return Xt(Yt(t,e,n),i,$t(t,e,n),2*Math.PI*n,r)}function Rt(t,e,n,i,r){var s=Nt(e,n,i,t,r);return function(t){return s(1-t)}}function Qt(t,e,n,i,r,s){return Xt(Ut(t,e,n,i),r,Kt(t,e,n,i),2*n+2*i,s)}function Jt(t,e,n,i,r,s){var o=Qt(e,n,i,r,t,s);return function(t){return o(1-t)}}function Xt(t,e,n,i,r){void 0===r&&(r={});var s=r.maxSegmentLength;void 0===s&&(s=10);var o=r.string;void 0===o&&(o=!0);var a,h,u=$(e,s);return Z(i)&&u.length<i/s&&U(u,Math.ceil(i/s-u.length)),a=t(u),h=D(a,u,o),o?function(t){return t<1e-4?n:h(t)}:h}function Yt(a,h,u){return function(i){var t=B(i),r=ne(i.concat([i[0]])),s=Math.atan2(i[0][1]-t[1],i[0][0]-t[0]),o=0;return i.map(function(t,e){var n;return e&&(o+=q(t,i[e-1])),n=s+2*Math.PI*(r?o/r:e/i.length),[Math.cos(n)*u+a,Math.sin(n)*u+h]})}}function Ut(a,h,u,p){return function(i){var t=B(i),r=ne(i.concat([i[0]])),e=Math.atan2(i[0][1]-t[1],i[0][0]-t[0]),s=0;e<0&&(e=2*Math.PI+e);var o=e/(2*Math.PI);return i.map(function(t,e){e&&(s+=q(t,i[e-1]));var n=Wt((o+(r?s/r:e/i.length))%1);return[a+n[0]*u,h+n[1]*p]})}}function Wt(t){return t<=1/8?[1,.5+4*t]:t<=3/8?[1.5-4*t,1]:t<=5/8?[0,2.5-4*t]:t<=7/8?[4*t-2.5,0]:[1,4*t-3.5]}function $t(t,e,n){var i=t-n+","+e,r=t+n+","+e,s="A"+n+","+n+",0,1,1,";return"M"+i+s+r+s+i+"Z"}function Kt(t,e,n,i){var r=t+n,s=e+i;return"M"+t+","+e+"L"+r+","+e+"L"+r+","+s+"L"+t+","+s+"Z"}var te=function(t){for(var e,n=-1,i=t.length,r=t[i-1],s=0;++n<i;)e=r,r=t[n],s+=e[1]*r[0]-e[0]*r[1];return s/2},ee=function(t){for(var e,n,i=-1,r=t.length,s=0,o=0,a=t[r-1],h=0;++i<r;)e=a,a=t[i],h+=n=e[0]*a[1]-a[0]*e[1],s+=(e[0]+a[0])*n,o+=(e[1]+a[1])*n;return h*=3,[s/h,o/h]},ne=function(t){for(var e,n,i=-1,r=t.length,s=t[r-1],o=s[0],a=s[1],h=0;++i<r;)e=o,n=a,s=t[i],o=s[0],a=s[1],e-=o,n-=a,h+=Math.sqrt(e*e+n*n);return h},ie={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},re=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279],se=function(t){var e=new i(t),n=e.max;for(h(e);e.index<n&&!e.err.length;)r(e);return e.err.length?e.result=[]:e.result.length&&("mM".indexOf(e.result[0][0])<0?(e.err="SvgPath: string should start with `M` or `m`",e.result=[]):e.result[0][0]="M"),{err:e.err,segments:e.result}};s.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]?this:(this.cache=null,this.queue.push(t),this)},s.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},s.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},s.prototype.rotate=function(t,e,n){var i,r,s;return 0!==t&&(this.translate(e,n),i=t*Math.PI/180,r=Math.cos(i),s=Math.sin(i),this.queue.push([r,s,-s,r,0,0]),this.cache=null,this.translate(-e,-n)),this},s.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},s.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},s.prototype.toArray=function(){var t=this;if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var e=1;e<this.queue.length;e++)t.cache=n(t.cache,t.queue[e]);return this.cache},s.prototype.calc=function(t,e,n){var i;return this.queue.length?(this.cache||(this.cache=this.toArray()),i=this.cache,[t*i[0]+e*i[2]+(n?0:i[4]),t*i[1]+e*i[3]+(n?0:i[5])]):[t,e]};var oe=s,ae={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},he=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,ue=/[\s,]+/,pe=function(t){var e,n,i=new oe;return t.split(he).forEach(function(t){if(t.length){if(void 0!==ae[t])return void(e=t);switch(n=t.split(ue).map(function(t){return+t||0}),e){case"matrix":return void(6===n.length&&i.matrix(n));case"scale":return void(1===n.length?i.scale(n[0],n[0]):2===n.length&&i.scale(n[0],n[1]));case"rotate":return void(1===n.length?i.rotate(n[0],0,0):3===n.length&&i.rotate(n[0],n[1],n[2]));case"translate":return void(1===n.length?i.translate(n[0],0):2===n.length&&i.translate(n[0],n[1]));case"skewX":return void(1===n.length&&i.skewX(n[0]));case"skewY":return void(1===n.length&&i.skewY(n[0]))}}}),i},le=2*Math.PI,ce=function(t,e,n,i,r,s,o,a,h){var u=Math.sin(h*le/360),p=Math.cos(h*le/360),l=p*(t-n)/2+u*(e-i)/2,c=-u*(t-n)/2+p*(e-i)/2;if(0===l&&0===c)return[];if(0===o||0===a)return[];o=Math.abs(o),a=Math.abs(a);var f=l*l/(o*o)+c*c/(a*a);f>1&&(o*=Math.sqrt(f),a*=Math.sqrt(f));var g=x(t,e,n,i,r,s,o,a,u,p),y=[],_=g[2],m=g[3],v=Math.max(Math.ceil(Math.abs(m)/(le/4)),1);m/=v;for(var d=0;d<v;d++)y.push(P(_,m)),_+=m;return y.map(function(t){for(var e=0;e<t.length;e+=2){var n=t[e+0],i=t[e+1];n*=o,i*=a;var r=p*n-u*i,s=u*n+p*i;t[e+0]=r+g[0],t[e+1]=s+g[1]}return t})},fe=Math.PI/180;c.prototype.transform=function(t){var e=Math.cos(this.ax*fe),n=Math.sin(this.ax*fe),i=[this.rx*(t[0]*e+t[2]*n),this.rx*(t[1]*e+t[3]*n),this.ry*(-t[0]*n+t[2]*e),this.ry*(-t[1]*n+t[3]*e)],r=i[0]*i[0]+i[2]*i[2],s=i[1]*i[1]+i[3]*i[3],o=((i[0]-i[3])*(i[0]-i[3])+(i[2]+i[1])*(i[2]+i[1]))*((i[0]+i[3])*(i[0]+i[3])+(i[2]-i[1])*(i[2]-i[1])),a=(r+s)/2;if(o<1e-10*a)return this.rx=this.ry=Math.sqrt(a),this.ax=0,this;var h=i[0]*i[1]+i[2]*i[3];o=Math.sqrt(o);var u=a+o/2,p=a-o/2;return this.ax=Math.abs(h)<1e-10&&Math.abs(u-s)<1e-10?90:180*Math.atan(Math.abs(h)>Math.abs(u-s)?(u-r)/h:h/(u-s))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(u),this.ry=Math.sqrt(p)):(this.ax+=90,this.rx=Math.sqrt(p),this.ry=Math.sqrt(u)),this},c.prototype.isDegenerate=function(){return this.rx<1e-10*this.ry||this.ry<1e-10*this.rx};var ge=c;f.prototype.__matrix=function(p){var l,c=this;p.queue.length&&this.iterate(function(t,e,n,i){var r,s,o,a;switch(t[0]){case"v":r=p.calc(0,t[1],!0),s=0===r[0]?["v",r[1]]:["l",r[0],r[1]];break;case"V":r=p.calc(n,t[1],!1),s=r[0]===p.calc(n,i,!1)[0]?["V",r[1]]:["L",r[0],r[1]];break;case"h":r=p.calc(t[1],0,!0),s=0===r[1]?["h",r[0]]:["l",r[0],r[1]];break;case"H":r=p.calc(t[1],i,!1),s=r[1]===p.calc(n,i,!1)[1]?["H",r[0]]:["L",r[0],r[1]];break;case"a":case"A":var h=p.toArray(),u=ge(t[1],t[2],t[3]).transform(h);if(h[0]*h[3]-h[1]*h[2]<0&&(t[5]=t[5]?"0":"1"),r=p.calc(t[6],t[7],"a"===t[0]),"A"===t[0]&&t[6]===n&&t[7]===i||"a"===t[0]&&0===t[6]&&0===t[7]){s=["a"===t[0]?"l":"L",r[0],r[1]];break}s=u.isDegenerate()?["a"===t[0]?"l":"L",r[0],r[1]]:[t[0],u.rx,u.ry,u.ax,t[4],t[5],r[0],r[1]];break;case"m":a=e>0,r=p.calc(t[1],t[2],a),s=["m",r[0],r[1]];break;default:for(o=t[0],s=[o],a=o.toLowerCase()===o,l=1;l<t.length;l+=2)r=p.calc(t[l],t[l+1],a),s.push(r[0],r[1])}c.segments[e]=s},!0)},f.prototype.__evaluateStack=function(){var t,e,n=this;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=oe(),e=this.__stack.length;--e>=0;)t.matrix(n.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},f.prototype.toString=function(){var t,e,n=this,i=[];this.__evaluateStack();for(var r=0;r<this.segments.length;r++)e=n.segments[r][0],t=r>0&&"m"!==e&&"M"!==e&&e===n.segments[r-1][0],i=i.concat(t?n.segments[r].slice(1):n.segments[r]);return i.join(" ").replace(/ ?([achlmqrstvz]) ?/gi,"$1").replace(/ \-/g,"-").replace(/zm/g,"z m")},f.prototype.translate=function(t,e){return this.__stack.push(oe().translate(t,e||0)),this},f.prototype.scale=function(t,e){return this.__stack.push(oe().scale(t,e||0===e?e:t)),this},f.prototype.rotate=function(t,e,n){return this.__stack.push(oe().rotate(t,e||0,n||0)),this},f.prototype.skewX=function(t){return this.__stack.push(oe().skewX(t)),this},f.prototype.skewY=function(t){return this.__stack.push(oe().skewY(t)),this},f.prototype.matrix=function(t){return this.__stack.push(oe().matrix(t)),this},f.prototype.transform=function(t){return t.trim()?(this.__stack.push(pe(t)),this):this},f.prototype.round=function(i){var e,r=0,s=0,o=0,a=0;return i=i||0,this.__evaluateStack(),this.segments.forEach(function(n){var t=n[0].toLowerCase()===n[0];switch(n[0]){case"H":case"h":return t&&(n[1]+=o),o=n[1]-n[1].toFixed(i),void(n[1]=+n[1].toFixed(i));case"V":case"v":return t&&(n[1]+=a),a=n[1]-n[1].toFixed(i),void(n[1]=+n[1].toFixed(i));case"Z":case"z":return o=r,void(a=s);case"M":case"m":return t&&(n[1]+=o,n[2]+=a),o=n[1]-n[1].toFixed(i),a=n[2]-n[2].toFixed(i),r=o,s=a,n[1]=+n[1].toFixed(i),void(n[2]=+n[2].toFixed(i));case"A":case"a":return t&&(n[6]+=o,n[7]+=a),o=n[6]-n[6].toFixed(i),a=n[7]-n[7].toFixed(i),n[1]=+n[1].toFixed(i),n[2]=+n[2].toFixed(i),n[3]=+n[3].toFixed(i+2),n[6]=+n[6].toFixed(i),void(n[7]=+n[7].toFixed(i));default:return e=n.length,t&&(n[e-2]+=o,n[e-1]+=a),o=n[e-2]-n[e-2].toFixed(i),a=n[e-1]-n[e-1].toFixed(i),void n.forEach(function(t,e){e&&(n[e]=+n[e].toFixed(i))})}}),this},f.prototype.iterate=function(r,t){var e,n,i,s=this.segments,o={},a=!1,h=0,u=0,p=0,l=0;if(t||this.__evaluateStack(),s.forEach(function(t,e){var n=r(t,e,h,u);Array.isArray(n)&&(o[e]=n,a=!0);var i=t[0]===t[0].toLowerCase();switch(t[0]){case"m":case"M":return h=t[1]+(i?h:0),u=t[2]+(i?u:0),p=h,void(l=u);case"h":case"H":return void(h=t[1]+(i?h:0));case"v":case"V":return void(u=t[1]+(i?u:0));case"z":case"Z":return h=p,void(u=l);default:h=t[t.length-2]+(i?h:0),u=t[t.length-1]+(i?u:0)}}),!a)return this;for(i=[],e=0;e<s.length;e++)if(void 0!==o[e])for(n=0;n<o[e].length;n++)i.push(o[e][n]);else i.push(s[e]);return this.segments=i,this},f.prototype.abs=function(){return this.iterate(function(t,e,n,i){var r,s=t[0],o=s.toUpperCase();if(s!==o)switch(t[0]=o,s){case"v":return void(t[1]+=i);case"a":return t[6]+=n,void(t[7]+=i);default:for(r=1;r<t.length;r++)t[r]+=r%2?n:i}},!0),this},f.prototype.rel=function(){return this.iterate(function(t,e,n,i){var r,s=t[0],o=s.toLowerCase();if(s!==o&&(0!==e||"M"!==s))switch(t[0]=o,s){case"V":return void(t[1]-=i);case"A":return t[6]-=n,void(t[7]-=i);default:for(r=1;r<t.length;r++)t[r]-=r%2?n:i}},!0),this},f.prototype.unarc=function(){return this.iterate(function(t,e,n,i){var r,s,o,a=[],h=t[0];return"A"!==h&&"a"!==h?null:("a"===h?(s=n+t[6],o=i+t[7]):(s=t[6],o=t[7]),r=ce(n,i,s,o,t[4],t[5],t[1],t[2],t[3]),0===r.length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(r.forEach(function(t){a.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])}),a))}),this},f.prototype.unshort=function(){var a,h,u,p,l,c=this.segments;return this.iterate(function(t,e,n,i){var r,s=t[0],o=s.toUpperCase();e&&("T"===o?(r="t"===s,u=c[e-1],"Q"===u[0]?(a=u[1]-n,h=u[2]-i):"q"===u[0]?(a=u[1]-u[3],h=u[2]-u[4]):(a=0,h=0),p=-a,l=-h,r||(p+=n,l+=i),c[e]=[r?"q":"Q",p,l,t[1],t[2]]):"S"===o&&(r="s"===s,u=c[e-1],"C"===u[0]?(a=u[3]-n,h=u[4]-i):"c"===u[0]?(a=u[3]-u[5],h=u[4]-u[6]):(a=0,h=0),p=-a,l=-h,r||(p+=n,l+=i),c[e]=[r?"c":"C",p,l,t[1],t[2],t[3],t[4]]))}),this};var ye,_e=f,me={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},ve=/([astvzqmhlc])([^astvzqmhlc]*)/gi,de=function(t){var r=[];return t.replace(ve,function(t,e,n){var i=e.toLowerCase();for(n=g(n),"m"===i&&n.length>2&&(r.push([e].concat(n.splice(0,2))),i="l",e="m"===e?"l":"L");n.length>=0;){if(n.length===me[i])return n.unshift(e),r.push(n);if(n.length<me[i])throw new Error("malformed path data");r.push([e].concat(n.splice(0,me[i])))}}),r},xe=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,Pe=function(t,e,n,i,r,s,o,a){return new y(t,e,n,i,r,s,o,a)};y.prototype={constructor:y,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(t){var e=v(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e)},getTangentAtLength:function(t){var e=v(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),n=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],e),i=Math.sqrt(n.x*n.x+n.y*n.y);return i>0?{x:n.x/i,y:n.y/i}:{x:0,y:0}},getPropertiesAtLength:function(t){var e,n=v(t,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),i=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n),r=Math.sqrt(i.x*i.x+i.y*i.y);e=r>0?{x:i.x/r,y:i.y/r}:{x:0,y:0};var s=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],n);return{x:s.x,y:s.y,tangentX:e.x,tangentY:e.y}}};var Me=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],be=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],we=[[1],[1,1],[1,2,1],[1,3,3,1]],Oe=2*Math.PI,Le=function(t,e,o,a,n,i,r,s,h){var u=Math.sin(n*Oe/360),p=Math.cos(n*Oe/360),l=p*(t-s)/2+u*(e-h)/2,c=-u*(t-s)/2+p*(e-h)/2;if(0===l&&0===c)return[];if(0===o||0===a)return[];o=Math.abs(o),a=Math.abs(a);var f=l*l/(o*o)+c*c/(a*a);f>1&&(o*=Math.sqrt(f),a*=Math.sqrt(f));var g=C(t,e,s,h,i,r,o,a,u,p),y=[],_=g[2],m=g[3],v=Math.max(Math.ceil(Math.abs(m)/(Oe/4)),1);m/=v;for(var d=0;d<v;d++)y.push(T(_,m)),_+=m;return y.map(function(t){for(var e=0;e<t.length;e+=2){var n=t[e+0],i=t[e+1];n*=o,i*=a;var r=p*n-u*i,s=u*n+p*i;t[e+0]=r+g[0],t[e+1]=s+g[1]}return t})},Ae=function(t,e,n,i,r,s,o,a,h){return new S(t,e,n,i,r,s,o,a,h)};S.prototype={constructor:S,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(t){var e=this;t<0?t=0:t>this.length&&(t=this.length);for(var n=this.partialLengths.length-1;this.partialLengths[n]>=t&&this.partialLengths[n]>0;)n--;n<this.partialLengths.length-1&&n++;for(var i=0,r=0;r<n;r++)i+=e.partialLengths[r];return this.curves[n].getPointAtLength(t-i)},getTangentAtLength:function(t){var e=this;t<0?t=0:t>this.length&&(t=this.length);for(var n=this.partialLengths.length-1;this.partialLengths[n]>=t&&this.partialLengths[n]>0;)n--;n<this.partialLengths.length-1&&n++;for(var i=0,r=0;r<n;r++)i+=e.partialLengths[r];return this.curves[n].getTangentAtLength(t-i)},getPropertiesAtLength:function(t){var e=this.getTangentAtLength(t),n=this.getPointAtLength(t);return{x:n.x,y:n.y,tangentX:e.x,tangentY:e.y}}};var Ie=function(t,e,n,i){return new F(t,e,n,i)};F.prototype.getTotalLength=function(){return Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2))},F.prototype.getPointAtLength=function(t){var e=t/Math.sqrt(Math.pow(this.x0-this.x1,2)+Math.pow(this.y0-this.y1,2)),n=(this.x1-this.x0)*e,i=(this.y1-this.y0)*e;return{x:this.x0+n,y:this.y0+i}},F.prototype.getTangentAtLength=function(){var t=Math.sqrt((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/t,y:(this.y1-this.y0)/t}},F.prototype.getPropertiesAtLength=function(t){var e=this.getPointAtLength(t),n=this.getTangentAtLength();return{x:e.x,y:e.y,tangentX:n.x,tangentY:n.y}};var ke=function(t){function o(t){if(!t)return null;for(var e,n=de(t),i=[0,0],r=[0,0],s=0;s<n.length;s++)"M"===n[s][0]?(i=[n[s][1],n[s][2]],u.push(null)):"m"===n[s][0]?(i=[n[s][1]+i[0],n[s][2]+i[1]],u.push(null)):"L"===n[s][0]?(a+=Math.sqrt(Math.pow(i[0]-n[s][1],2)+Math.pow(i[1]-n[s][2],2)),u.push(new Ie(i[0],n[s][1],i[1],n[s][2])),i=[n[s][1],n[s][2]]):"l"===n[s][0]?(a+=Math.sqrt(Math.pow(n[s][1],2)+Math.pow(n[s][2],2)),u.push(new Ie(i[0],n[s][1]+i[0],i[1],n[s][2]+i[1])),i=[n[s][1]+i[0],n[s][2]+i[1]]):"H"===n[s][0]?(a+=Math.abs(i[0]-n[s][1]),u.push(new Ie(i[0],n[s][1],i[1],i[1])),i[0]=n[s][1]):"h"===n[s][0]?(a+=Math.abs(n[s][1]),u.push(new Ie(i[0],i[0]+n[s][1],i[1],i[1])),i[0]=n[s][1]+i[0]):"V"===n[s][0]?(a+=Math.abs(i[1]-n[s][1]),u.push(new Ie(i[0],i[0],i[1],n[s][1])),i[1]=n[s][1]):"v"===n[s][0]?(a+=Math.abs(n[s][1]),u.push(new Ie(i[0],i[0],i[1],i[1]+n[s][1])),i[1]=n[s][1]+i[1]):"z"===n[s][0]||"Z"===n[s][0]?(a+=Math.sqrt(Math.pow(n[0][1]-i[0],2)+Math.pow(n[0][2]-i[1],2)),u.push(new Ie(i[0],n[0][1],i[1],n[0][2])),i=[n[0][1],n[0][2]]):"C"===n[s][0]?(e=new Pe(i[0],i[1],n[s][1],n[s][2],n[s][3],n[s][4],n[s][5],n[s][6]),a+=e.getTotalLength(),i=[n[s][5],n[s][6]],u.push(e)):"c"===n[s][0]?(e=new Pe(i[0],i[1],i[0]+n[s][1],i[1]+n[s][2],i[0]+n[s][3],i[1]+n[s][4],i[0]+n[s][5],i[1]+n[s][6]),a+=e.getTotalLength(),i=[n[s][5]+i[0],n[s][6]+i[1]],u.push(e)):"S"===n[s][0]?(e=s>0&&["C","c","S","s"].indexOf(n[s-1][0])>-1?new Pe(i[0],i[1],2*i[0]-n[s-1][n[s-1].length-4],2*i[1]-n[s-1][n[s-1].length-3],n[s][1],n[s][2],n[s][3],n[s][4]):new Pe(i[0],i[1],i[0],i[1],n[s][1],n[s][2],n[s][3],n[s][4]),a+=e.getTotalLength(),i=[n[s][3],n[s][4]],u.push(e)):"s"===n[s][0]?(e=s>0&&["C","c","S","s"].indexOf(n[s-1][0])>-1?new Pe(i[0],i[1],i[0]+e.d.x-e.c.x,i[1]+e.d.y-e.c.y,i[0]+n[s][1],i[1]+n[s][2],i[0]+n[s][3],i[1]+n[s][4]):new Pe(i[0],i[1],i[0],i[1],i[0]+n[s][1],i[1]+n[s][2],i[0]+n[s][3],i[1]+n[s][4]),a+=e.getTotalLength(),i=[n[s][3]+i[0],n[s][4]+i[1]],u.push(e)):"Q"===n[s][0]?(e=new Pe(i[0],i[1],n[s][1],n[s][2],n[s][3],n[s][4]),a+=e.getTotalLength(),u.push(e),i=[n[s][3],n[s][4]],r=[n[s][1],n[s][2]]):"q"===n[s][0]?(e=new Pe(i[0],i[1],i[0]+n[s][1],i[1]+n[s][2],i[0]+n[s][3],i[1]+n[s][4]),a+=e.getTotalLength(),r=[i[0]+n[s][1],i[1]+n[s][2]],i=[n[s][3]+i[0],n[s][4]+i[1]],u.push(e)):"T"===n[s][0]?(e=s>0&&["Q","q","T","t"].indexOf(n[s-1][0])>-1?new Pe(i[0],i[1],2*i[0]-r[0],2*i[1]-r[1],n[s][1],n[s][2]):new Ie(i[0],n[s][1],i[1],n[s][2]),u.push(e),a+=e.getTotalLength(),r=[2*i[0]-r[0],2*i[1]-r[1]],i=[n[s][1],n[s][2]]):"t"===n[s][0]?(e=s>0&&["Q","q","T","t"].indexOf(n[s-1][0])>-1?new Pe(i[0],i[1],2*i[0]-r[0],2*i[1]-r[1],i[0]+n[s][1],i[1]+n[s][2]):new Ie(i[0],i[0]+n[s][1],i[1],i[1]+n[s][2]),a+=e.getTotalLength(),r=[2*i[0]-r[0],2*i[1]-r[1]],i=[n[s][1]+i[0],n[s][2]+i[0]],u.push(e)):"A"===n[s][0]?(e=new Ae(i[0],i[1],n[s][1],n[s][2],n[s][3],n[s][4],n[s][5],n[s][6],n[s][7]),a+=e.getTotalLength(),i=[n[s][6],n[s][7]],u.push(e)):"a"===n[s][0]&&(e=new Ae(i[0],i[1],n[s][1],n[s][2],n[s][3],n[s][4],n[s][5],i[0]+n[s][6],i[1]+n[s][7]),a+=e.getTotalLength(),i=[i[0]+n[s][6],i[1]+n[s][7]],u.push(e)),h.push(a);return o}var a=0,h=[],u=[];o.getTotalLength=function(){return a},o.getPointAtLength=function(t){var e=n(t);return u[e.i].getPointAtLength(e.fraction)},o.getTangentAtLength=function(t){var e=n(t);return u[e.i].getTangentAtLength(e.fraction)},o.getPropertiesAtLength=function(t){var e=n(t);return u[e.i].getPropertiesAtLength(e.fraction)};var n=function(t){t<0?t=0:t>a&&(t=a);for(var e=h.length-1;h[e]>=t&&h[e]>0;)e--;return e++,{fraction:t-h[e-1],i:e}};return o(t)},Ce='All shapes must be supplied as arrays of [x, y] points or an SVG path string (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d).\nExample valid ways of supplying a shape would be:\n[[0, 0], [10, 0], [10, 10]]\n"M0,0 L10,0 L10,10Z"\n',Te="flubber.all() expects two arrays of equal length as arguments. Each element in both arrays should be an array of [x, y] points or an SVG path string (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d).",Se=function(r,t){for(var e,s,n,o=r.length,a=1/0,i=0;i<o;i++)!function(i){s=0,t.forEach(function(t,e){var n=q(r[(i+e)%o],t);s+=n*n}),s<a&&(a=s,e=i)}(i);e&&(n=r.splice(0,e),r.splice.apply(r,[r.length,0].concat(n)))},Fe=function(e,n,t){void 0===t&&(t={});var i=t.maxSegmentLength;void 0===i&&(i=10);var r=t.string;void 0===r&&(r=!0);var s=$(e,i),o=$(n,i),a=tt(s,o,r);return!r||"string"!=typeof e&&"string"!=typeof n?a:function(t){return t<1e-4&&"string"==typeof e?e:1-t<1e-4&&"string"==typeof n?n:a(t)}},qe=et;et.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(kt(t,0,s,n));if(r)for(var a=0,h=e.length;a<h;a++){var u=e[a]*n,p=a<h-1?e[a+1]*n:t.length;o-=Math.abs(kt(t,u,p,n))}var l=0;for(a=0;a<i.length;a+=3){var c=i[a]*n,f=i[a+1]*n,g=i[a+2]*n;l+=Math.abs((t[c]-t[g])*(t[f+1]-t[c+1])-(t[c]-t[f])*(t[g+1]-t[c+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},et.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var Ee=function(t){return t},Ge=function(t){if(null==t)return Ee;var s,o,a=t.scale[0],h=t.scale[1],u=t.translate[0],p=t.translate[1];return function(t,e){e||(s=o=0);var n=2,i=t.length,r=new Array(i);for(r[0]=(s+=t[0])*a+u,r[1]=(o+=t[1])*h+p;n<i;)r[n]=t[n],++n;return r}},De=function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n},je=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return Ct(e,t)})}:Ct(e,t)},Ze=function(r,s){function h(t){var e,n=r.arcs[t<0?~t:t],i=n[0];return r.transform?(e=[0,0],n.forEach(function(t){e[0]+=t[0],e[1]+=t[1]})):e=n[n.length-1],t<0?[e,i]:[i,e]}function t(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){o[t<0?~t:t]=1}),a.push(i)}}var o={},u={},p={},a=[],l=-1;return s.forEach(function(t,e){var n,i=r.arcs[t<0?~t:t];i.length<3&&!i[1][0]&&!i[1][1]&&(n=s[++l],s[l]=t,s[e]=n)}),s.forEach(function(t){var e,n,i=h(t),r=i[0],s=i[1];if(e=p[r])if(delete p[e.end],e.push(t),e.end=s,n=u[s]){delete u[n.start];var o=n===e?e:e.concat(n);u[o.start=e.start]=p[o.end=n.end]=o}else u[e.start]=p[e.end]=e;else if(e=u[s])if(delete u[e.start],e.unshift(t),e.start=r,n=p[r]){delete p[n.end];var a=n===e?e:n.concat(e);u[a.start=n.start]=p[a.end=e.end]=a}else u[e.start]=p[e.end]=e;else e=[t],u[e.start=r]=p[e.end=s]=e}),t(p,u),t(u,p),s.forEach(function(t){o[t<0?~t:t]||a.push([t])}),a},Be=function(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n},ze=function(t){function n(t,n){t.forEach(function(t){t<0&&(t=~t);var e=s[t];e?e.push(n):s[t]=[n]})}function i(t,e){t.forEach(function(t){n(t,e)})}function r(t,e){"GeometryCollection"===t.type?t.geometries.forEach(function(t){r(t,e)}):t.type in o&&o[t.type](t.arcs,e)}var s={},e=t.map(function(){return[]}),o={LineString:n,MultiLineString:i,Polygon:i,MultiPolygon:function(t,e){t.forEach(function(t){i(t,e)})}};t.forEach(r);for(var a in s)for(var h=s[a],u=h.length,p=0;p<u;++p)for(var l=p+1;l<u;++l){var c,f=h[p],g=h[l];(c=e[f])[a=Be(c,g)]!==g&&c.splice(a,0,g),(c=e[g])[a=Be(c,f)]!==f&&c.splice(a,0,f)}return e},He=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Ve=function(s){return 1===s.length&&(s=qt(s)),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;s(t[r],e)<0?n=r+1:i=r}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;s(t[r],e)>0?i=r:n=r+1}return n}}},Ne=Ve(He),Re=function(t,e){return Gt(Et(Dt(t),t),e)},Qe=function(t,n){if(t.length>8)return t.map(function(t,e){return e});var e=t.map(function(e){return n.map(function(t){return Zt(e,t)})});return jt(t,n,e)};t.interpolate=Fe,t.separate=Bt,t.combine=zt,t.interpolateAll=Ht,t.splitPathString=R,t.toPathString=N,t.fromCircle=Nt,t.toCircle=Rt,t.fromRect=Qt,t.toRect=Jt,Object.defineProperty(t,"__esModule",{value:!0})}(t)}((E={exports:{}},E.exports)),E.exports),j=(G=D)&&G.__esModule&&Object.prototype.hasOwnProperty.call(G,"default")?G.default:G,Z=(B.prototype.interpolate=function(t){return this._constantPositions?this._constantPositions:this._interpolator(t)},B);function B(t,n){var i=!0;t.length!==n.length&&(i=!1),i&&t.forEach(function(t,e){i=i&&g.data.Position.areEqual(t,n[e])}),i?this._constantPositions=n:this._interpolator=j.interpolate(t,n,{string:!1})}var z=(H.prototype.interpolate=function(t){if(this._areSame)return this._toGeometry;if(0===t)return this._fromGeometry;if(1===t)return this._toGeometry;var e=this._runInterpolators(t),n={type:this._toGeometry.type};switch(this._toGeometry.type){case"Point":"LineString"===this._fromGeometry.type||"MultiPoint"===this._fromGeometry.type?n={type:this._fromGeometry.type,coordinates:this._sampleMultiPoint(e,this._fromGeometry.coordinates.length)}:"Polygon"===this._fromGeometry.type||"MultiLineString"===this._fromGeometry.type?n={type:this._fromGeometry.type,coordinates:e}:n.coordinates=e[0][0];break;case"LineString":if("Polygon"===this._fromGeometry.type&&this._fromGeometry.coordinates.length>this._toGeometry.coordinates.length)for(var i=Math.floor(e[0].length/(this._toGeometry.coordinates.length-1));0<=i;i--)e[0].pop();n.coordinates=e[0];break;case"MultiPoint":"Point"===this._fromGeometry.type?n.coordinates=this._sampleMultiPoint(e,this._toGeometry.coordinates.length):"MultiPoint"!==this._fromGeometry.type?n={type:this._fromGeometry.type,coordinates:"LineString"===this._fromGeometry.type?e[0]:e}:n.coordinates=e[0];break;case"Polygon":case"MultiLineString":n.coordinates=e}return n},H.prototype._initInterpolators=function(){if(!this._areSame&&this._fromGeometry&&0<this._fromGeometry.coordinates.length&&this._toGeometry&&0<this._toGeometry.coordinates.length){var t=[],e=[];switch(this._fromGeometry.type){case"Point":var n=this._fromGeometry.coordinates;t=[[n,n,n]];break;case"LineString":case"MultiPoint":t=[this._fromGeometry.coordinates];break;case"Polygon":case"MultiLineString":t="number"==typeof this._fromGeometry.coordinates[0]?[this._fromGeometry.coordinates]:this._fromGeometry.coordinates}switch(this._toGeometry.type){case"Point":var i=this._toGeometry.coordinates;e=[[i,i,i]];break;case"LineString":case"MultiPoint":e=[this._toGeometry.coordinates];break;case"Polygon":case"MultiLineString":e="number"==typeof this._toGeometry.coordinates[0]?[this._toGeometry.coordinates]:this._toGeometry.coordinates}if(t.length<e.length)for(var r=t.length,s=e.length;r<s;r++)t.push([t[0][0],t[0][0],t[0][0]]);for(r=0;r<e.length;r++)this._interpolators.push(new Z(t[r],e[r]))}},H.prototype._runInterpolators=function(t){for(var e=[],n=0;n<this._interpolators.length;n++)e.push(this._interpolators[n].interpolate(t));return e},H.prototype._sampleMultiPoint=function(t,e){for(var n=Math.min(Math.ceil(t[0].length/e),e),i=[],r=0;r<e;r++)i.push(t[0][r*n]);return i},H);function H(t,e){if(this._interpolators=[],this._areSame=!1,"MultiPolygon"===t.type)throw"Only simple geometries supported.";this._fromGeometry=t,this._toGeometry=e,this._areSame=this._fromGeometry.type===this._toGeometry.type&&JSON.parse(JSON.stringify(this._fromGeometry.coordinates))===JSON.parse(JSON.stringify(this._toGeometry.coordinates)),this._initInterpolators()}var V=(N.prototype.interpolate=function(e){if(0===e)return this._fromGeometry;if(1===e)return this._toGeometry;if("MultiPolygon"===this._toGeometry.type){var n=[];return this._interpolators.forEach(function(t){n.push(t.interpolate(e).coordinates)}),{type:"MultiPolygon",coordinates:n}}if("GeometryCollection"!==this._toGeometry.type)return this._interpolators[0].interpolate(e);var i=[];return this._interpolators.forEach(function(t){i.push(t.interpolate(e))}),{type:"GeometryCollection",geometries:i}},N.prototype._initInterpolators=function(){var t=[],e=[];if(this.extractGeometries(this._fromGeometry,t),this.extractGeometries(this._toGeometry,e),t.length<e.length&&0<t.length){var n=g.data.BoundingBox.getCenter(g.data.BoundingBox.fromData(t[0])),i={type:t[0].type,coordinates:[]};switch(t[0].type){case"Point":i.coordinates=n;break;case"LineString":case"MultiPoint":i.coordinates=[n,n];break;case"MultiLineString":case"Polygon":i.coordinates=[[n,n,n]]}for(var r=t.length,s=e.length;r<s;r++)t.push(i)}for(r=0;r<e.length;r++)this._interpolators.push(new z(t[r],e[r]))},N.prototype.extractGeometries=function(t,e){var n=this;switch(t.type){case"MultiPolygon":t.coordinates.forEach(function(t){e.push({type:"Polygon",coordinates:t})});break;case"GeometryCollection":t.geometries.forEach(function(t){n.extractGeometries(t,e)});break;default:e.push(t)}},N);function N(t,e){this._interpolators=[],this._fromGeometry=t,this._toGeometry=e,this._initInterpolators()}var R,Q=(e(J,R=A),J.prototype.onAnimationProgress=function(t){var e=this._interpolator.interpolate(t),n=g.data.BoundingBox.getCenter(g.data.BoundingBox.fromData(e)),i=0;return i=this._pathOptions.geodesic?this._heading:this._pixelHeading,this._pathOptions.map&&this._setMapCamera(n,i,!0),this._pathOptions.captureMetadata&&this._shape.addProperty("heading",i),this._shape.isCircle()&&"Point"===e.type||(this._shape.data.geometry.type=e.type),this._shape.setCoordinates(e.coordinates),{position:n,heading:i}},J);function J(t,e,n){var i=R.call(this)||this;(i._shape=t).toJson().geometry;t.isCircle()&&"Point"!==e.type&&new g.data.Polygon(t.getCircleCoordinates()),i._interpolator=new V(t.toJson().geometry,e);var r=g.data.BoundingBox.getCenter(i._shape.getBounds()),s=g.data.BoundingBox.getCenter(g.data.BoundingBox.fromData(e));i._heading=g.math.getHeading(r,s);var o=g.math.mercatorPositionsToPixels([r,s],21);return i._pixelHeading=c.getPixelHeading(o[0],o[1]),n&&(i.setOptions(n),n.autoPlay&&i.play()),h.instance.add(i),i}var X=(Y.prototype.dispose=function(){h.instance.remove(this),this._id=void 0,this._delay=void 0,this._start=void 0,this._intervalCallback=void 0,this._numberOfIOntervals=void 0,this._currentInterval=void 0,this._onComplete=void 0},Y.prototype.getDuration=function(){return this._numberOfIOntervals*this._delay},Y.prototype.isPlaying=function(){return null!=this._start},Y.prototype.pause=function(){this._start=null},Y.prototype.play=function(){this._start=performance.now()},Y.prototype.reset=function(){this._start=null,this._currentInterval=0},Y.prototype.stop=function(){this._start=null,this._currentInterval=this._numberOfIOntervals},Y.prototype._onAnimationProgress=function(t){if(this._start){var e=Math.round((t-this._start)/this._delay);e!==this._currentInterval&&(this._currentInterval=e,this._intervalCallback&&setTimeout(this._intervalCallback,0,this._arguments),e>=this._numberOfIOntervals&&(this._start=null,this._onComplete&&(this._onComplete(),this.dispose())))}},Y);function Y(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];this._delay=1,this._numberOfIOntervals=1/0,this._currentInterval=0,this._id=h.instance.add(this),this._intervalCallback=t,this._arguments=i,0<=e&&(this._delay=e),0<n&&(this._numberOfIOntervals=n)}var U,W=(e($,U=A),$.prototype.dispose=function(){this._route=null,this._headingIntervals=null,this._positions=null,this._timestamps=null,this._timeIntervals=null,this._totalTime=null,this._shape=null,U.prototype.dispose.call(this)},$.prototype.getDuration=function(){return void 0!==this._totalTime?this._totalTime/this._pathOptions.speedMultiplier:U.prototype.getDuration.call(this)},$.prototype.getOptions=function(){return Object.assign({},U.prototype.getOptions.call(this),{valueInterpolations:this._valueInterpolations})},$.prototype.setOptions=function(t){if(t){t.valueInterpolations&&Array.isArray(t.valueInterpolations)&&(this._positions=null,this._valueInterpolations=t.valueInterpolations),U.prototype.setOptions.call(this,t);var e=this.isPlaying();e&&this.pause(),this._positions||(this._processPath(),this._pathOptions.captureMetadata&&0<this._headingIntervals.length&&c.setMetadata(this._shape,{heading:this._headingIntervals[0],speed:this._speedIntervals[0],timestamp:this._timestamps[0]})),e&&this.play()}},$.prototype.getTimeSpan=function(){return 0<this._timestamps.length?{begin:this._timestamps[0],end:this._timestamps[this._timestamps.length-1]}:null},$.prototype.getPath=function(){return JSON.parse(JSON.stringify(this._positions))},$.prototype.onAnimationProgress=function(t){var e=this;if(this._positions&&1<this._positions.length){var n,i={},r=0,s=0;if(1===t)r=this._headingIntervals.length-1,i.position=this._positions[r+1],i.heading=this._headingIntervals[r],i.speed=this._speedIntervals[r],i.timestamp=this._timestamps[r+1],this._pathOptions.map&&this._setMapCamera(i.position,i.heading,!1),c.setCoordinates(this._shape,i.position,this._positions),n=this._route[r].properties,s=1;else if(0===t)r=0,i.position=this._positions[0],i.heading=this._headingIntervals[0],i.speed=this._speedIntervals[0],i.timestamp=this._timestamps[0],this._pathOptions.map&&this._setMapCamera(i.position,i.heading,!1),c.setCoordinates(this._shape,i.position,[i.position,i.position]),n=this._route[0].properties;else{var o=this._totalTime*t,a=null;if(o>this._totalTime)r=this._headingIntervals.length-1,i.heading=this._headingIntervals[r],i.speed=this._speedIntervals[r],i.timestamp=this._timestamps[r+1],a=this._positions.slice(0),n=this._route[r+1].properties,s=1;else if(o<0)i.heading=this._headingIntervals[0],a=this._positions.slice(0,1);else{var h=0;for(r=0;r<this._headingIntervals.length;r++){if(h+this._timeIntervals[r]>=o){i.heading=this._headingIntervals[r],i.speed=this._speedIntervals[r],a=this._positions.slice(0,r+1);var u=o-h,p=this._speedIntervals[r]*u*.001;s=p/g.math.getDistanceTo(this._positions[r],this._positions[r+1]),i.timestamp=this._timestamps[r]+u,a.push(g.math.getDestination(this._positions[r],i.heading,p));break}h+=this._timeIntervals[r]}}a&&0<a.length&&(i.position=a[a.length-1],this._pathOptions.map&&this._setMapCamera(i.position,i.heading,2<a.length),c.setCoordinates(this._shape,i.position,a))}if(i=Object.assign(n||{},i),this._pathOptions.captureMetadata){var l={};this._valueInterpolations&&Array.isArray(this._valueInterpolations)&&this._valueInterpolations.forEach(function(t){c.interpolateValue(e._route[r],e._route[r+1],s,t,l)}),c.setMetadata(this._shape,Object.assign(i,l))}return i}return null},$.prototype._processPath=function(){if(this._route){var t=[];this._totalTime=0,this._positions=null,this._headingIntervals=[],this._speedIntervals=[],this._timeIntervals=[],this._timestamps=[];var e=this._route[0];if("Feature"!==e.type||"Point"!==e.geometry.type||"number"!=typeof e.properties._timestamp)throw"Feature is not a point or is missing a _timestamp value.";e=this._route[0],this._timestamps.push(e.properties._timestamp),t.push(e.geometry.coordinates);for(var n=1,i=this._route.length;n<i;n++)if("Feature"===(e=this._route[n]).type&&"Point"===e.geometry.type&&"number"==typeof e.properties._timestamp){t.push(e.geometry.coordinates);var r=g.math.getDistanceTo(t[n-1],t[n]);this._timestamps.push(e.properties._timestamp);var s=this._timestamps[n]-this._timestamps[n-1];this._timeIntervals.push(s),this._totalTime+=s,this._speedIntervals.push(r/(.001*s));var o=g.math.getHeading(t[n-1],t[n]);this._headingIntervals.push(o)}if(this._route.length!==t.length)throw this.dispose(),"Unable to process all points in route.";this._positions=t,U.prototype.setOptions.call(this,{duration:this._totalTime})}},$);function $(t,e,n){var i=U.call(this)||this;return i._shape=e,i._route=t,i.setOptions(Object.assign({rotate:!0,rotationOffset:0},n||{})),n&&n.autoPlay&&i.play(),i}function K(t){var e=h.instance.getById(t);e&&e.stop()}function tt(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=new X(t,e,1,n);return r.play(),r._id}var et,nt=(e(it,et=g.internal.EventEmitter),it.prototype.dispose=function(){this.stop(),this._options=null,this._animations=null,this._onComplete=null,this._isPlaying=null,this._cancelAnimations=null},it.prototype.getDuration=function(){return this._calculateDuration()},it.prototype.getOptions=function(){return Object.assign({},this._options)},it.prototype.isPlaying=function(){return this._isPlaying},it.prototype.play=function(){switch(this._cancelAnimations=!1,this._options.playType){case"together":this._playTogether();break;case"sequential":this._playSeq();break;case"interval":this._playInterval()}},it.prototype.reset=function(){if(this._cancelAnimations=!0,this._animations&&0<this._animations.length)for(var t=0;t<this._animations.length;t++)this._animations[t].reset();this._isPlaying=!1},it.prototype.stop=function(){if(this._cancelAnimations=!0,this._animations&&0<this._animations.length)for(var t=0;t<this._animations.length;t++)this._animations[t].stop();this._isPlaying=!1},it.prototype.setOptions=function(t){if(t){var e=this._isPlaying;e&&this.stop(),t.playType&&-1!==["together","sequential","interval"].indexOf(t.playType)&&(this._options.playType=t.playType),"boolean"==typeof t.autoPlay&&(this._options.autoPlay=t.autoPlay,!e&&t.autoPlay&&(e=!0)),"number"==typeof t.interval&&(this._options.interval=0<t.interval?Math.abs(t.interval):100),this._calculateDuration(),e&&this.play()}},it.prototype._playTogether=function(){var t=this;if(this._animations&&0<this._animations.length){this._isPlaying=!0;for(var e=0;e<this._animations.length;e++)e===this._animations.length-1&&(this._animations[e]._onComplete=function(){t._isPlaying=!1,t._invokeEvent("oncomplete",null)}),this._animations[e].play()}},it.prototype._playSeq=function(){var t=this;if(this._animations&&0<this._animations.length){this._isPlaying=!0;var e=0,n=function(){t._isPlaying&&(0<e&&(t._animations[e-1]._onComplete=null),!t._cancelAnimations&&e<t._animations.length?(t._animations[e]._onComplete=n,t._animations[e].play(),e++):(t._isPlaying=!1,t._invokeEvent("oncomplete",null)))};n()}},it.prototype._playInterval=function(){if(this._animations&&0<this._animations.length){this._isPlaying=!0;var t=this,e=0,n=function(){t._isPlaying&&(!t._cancelAnimations&&e<t._animations.length?(e===t._animations.length-1&&(t._animations[e]._onComplete=function(){t._isPlaying&&(t._isPlaying=!1,t._invokeEvent("oncomplete",null))}),t._animations[e].play(),e++,tt(function(){n()},t._options.interval)):t._cancelAnimations&&t._isPlaying&&(t._isPlaying=!1,t._invokeEvent("oncomplete",null)))};n()}},it.prototype._calculateDuration=function(){var r=this,s=0,o=0,a=0,h=0,u=this._options.interval*this._animations.length;this._animations.forEach(function(t,e,n){var i=t.getDuration();(o=u-e*r._options.interval)<i&&(s=Math.max(s,i-o)),a=Math.max(a,i),h+=i});var t=0;switch(this._options.playType){case"together":t=a;break;case"sequential":t=h;break;case"interval":t=s+u}return t},it);function it(t,e){var n=et.call(this)||this;return n._cancelAnimations=!1,n._isPlaying=!1,n._options={playType:"together",interval:100,autoPlay:!1},n._onComplete=function(){},n._animations=t,e?n.setOptions(e):n._calculateDuration(),n}var rt=Object.freeze({__proto__:null,FrameBasedAnimationTimer:m,GroupAnimation:nt,PlayableAnimation:l,drop:function(t,e,n,i){var r=[];if(Array.isArray(t))for(var s=0,o=t.length;s<o;s++)"Feature"===t[s].type&&"Point"===t[s].geometry.type||"Point"===t[s].type?r.push(new g.Shape(t[s])):t[s]instanceof g.Shape&&"Point"===t[s].getType()&&r.push(t[s]);else"Feature"===t.type&&"Point"===t.geometry.type||"Point"===t.type?r.push(new g.Shape(t)):t instanceof g.Shape&&"Point"===t.getType()&&r.push(t);if(0<r.length)return new w(r,e,n,i);throw"No supported shapes specified."},dropMarkers:function(t,e,n,i){var r=[];if(Array.isArray(t))for(var s=0,o=t.length;s<o;s++)t[s]instanceof g.HtmlMarker&&r.push(t[s]);else t instanceof g.HtmlMarker&&r.push(t);if(0<r.length)return new w(r,e,n,i);throw"No markers specified."},setCoordinates:function(t,e,n){var i=c.getSuitableCoordinates(t,e);if(t instanceof g.Shape)switch(t.getType()){case"Point":return new C(t,i,n);case"MultiPoint":case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return new Q(t,{type:t.getType(),coordinates:i},n)}return new C(t,i,n)},snakeline:function(t,e){if(t&&"LineString"===t.getType())return new F(t.getCoordinates().slice(0),t,e);throw"Specified shape is not a LineString type, or no map specified."},moveAlongPath:function(t,e,n){if(e&&(e instanceof g.HtmlMarker||e instanceof g.Shape&&"Point"===e.getType())||n&&n.map){var i;if(t)if(Array.isArray(t))i=t;else if(t instanceof g.Shape){if("LineString"===t.getType())i=t.getCoordinates();else if("Polygon"===t.getType()){var r=t.getCoordinates();0<r.length&&(i=r[0])}}else"LineString"===t.type&&(i=t.coordinates);if(i.length<2)throw"Invalid path option specified.";return new F(i,e,n)}throw"Specified shape is not a Point type, or not map specified."},moveAlongRoute:function(t,e,n){if(t.length<2)throw"Invalid path option specified.";return new W(t,e,n)},extractRoutePoints:function(t,e){var n;if(e=e||"_timestamp",Array.isArray(t)){var i;n=[];for(var r=0,s=t.length;r<s;r++){var o=void 0;if(o=t[r]instanceof g.Shape?t[r].toJson():t[r],!i&&-1===["Polygon","MultiLineString","MultiPolygon","GeometryCollection"].indexOf(o.geometry.type)&&(o.properties[e]||"number"==typeof o.properties._timestamp||"Point"!==o.geometry.type&&o.properties.waypoints)&&(i=o.geometry.type),i&&(0===n.length||"Point"===o.geometry.type)){var a=this.extractRoutePoints(o,e);if(a&&(n=n.concat(a),"Point"!==i))break}}}else t instanceof g.Shape?n=c.extractRoutePointsFromFeature(t.toJson(),e):"FeatureCollection"===t.type?n=this.extractRoutePoints(t.features,e):t.type&&(n=c.extractRoutePointsFromFeature(t,e));return 0<(n=n&&n.sort(function(t,e){return t.properties._timestamp-e.properties._timestamp})).length?n:null},morph:function(t,e,n){return new Q(t,e,n)},delay:function(t,e){return new X(e,t,1)},interval:function(t,e,n){return new X(e,t,Math.max(n||1/0,1))},setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=new X(t,e,1/0,n);return r.play(),r._id},clearInterval:K,setTimeout:tt,clearTimeout:function(t){K(t)},getEasingFn:function(t){return s[t]||null},getEasingNames:function(){return Object.keys(s)},flowingDashedLine:function(o,t){"round"===o.getOptions().lineCap&&o.setOptions({lineCap:"butt"});var a=t.dashLength||4,h=t.gapLength||4,u=40*a/(h+a),p=40-u;return new m(40,function(t){var e,n,i,r,s;s=t<u?(n=(1-(e=t/u))*a,i=h,r=e*a,0):(n=0,i=(1-(e=(t-u)/p))*h,r=a,e*h),o.setOptions({strokeDashArray:[n,i,r,s]})},t)}}),st=n.merge("atlas.layer",b),ot=n.merge("atlas.animations",rt);t.animations=ot,t.layer=st}(this.atlas=this.atlas||{},atlas);
